<!doctype html>
<html lang="default" dir="ltr" class="docs-wrapper docs-doc-page docs-version-2.X plugin-docs plugin-id-default docs-doc-id-guide/user/faq" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">FAQ | Nacos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://nacos.io/img/nacos_colorful.png"><meta data-rh="true" name="twitter:image" content="https://nacos.io/img/nacos_colorful.png"><meta data-rh="true" property="og:url" content="https://nacos.io/docs/guide/user/faq"><meta data-rh="true" name="docusaurus_locale" content="default"><meta data-rh="true" name="docsearch:language" content="default"><meta data-rh="true" name="docusaurus_version" content="2.X"><meta data-rh="true" name="docusaurus_tag" content="docs-default-2.X"><meta data-rh="true" name="docsearch:version" content="2.X"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-2.X"><meta data-rh="true" property="og:title" content="FAQ | Nacos"><meta data-rh="true" name="description" content="Nacos FAQ"><meta data-rh="true" property="og:description" content="Nacos FAQ"><meta data-rh="true" name="keywords" content="Nacos,FAQ"><link data-rh="true" rel="icon" href="https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png"><link data-rh="true" rel="canonical" href="https://nacos.io/docs/guide/user/faq"><link data-rh="true" rel="alternate" href="https://nacos.io/en/docs/guide/user/faq" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://nacos.io/zh-cn/docs/guide/user/faq" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://nacos.io/docs/guide/user/faq" hreflang="default"><link data-rh="true" rel="alternate" href="https://nacos.io/docs/guide/user/faq" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://1QV814950M-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Nacos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Nacos Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Nacos" href="/opensearch.xml">


<meta name="aes-config" content="pid=xux-opensource&amp;user_type=101&amp;uid=&amp;username=&amp;dim10=nacos">
<meta name="referrer" content="no-referrer">
<link rel="stylesheet" href="//g.alicdn.com/mamba/mse-arc-ui/0.0.21/umd/mse-arc-ui.min.css">
<script src="https://www.googletagmanager.com/gtag/js?id=G-0YDFJ7LX7F" async></script><link rel="stylesheet" href="/assets/css/styles.4eb69c24.css">
<link rel="preload" href="/assets/js/runtime~main.121161b6.js" as="script">
<link rel="preload" href="/assets/js/main.a6423de1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>



<script src="//g.alicdn.com/alilog/mlog/aplus_v2.js" id="beacon-aplus" exparams="clog=o&amp;aplus&amp;sidx=aplusSidx&amp;ckx=aplusCkx"></script>
<script src="//g.alicdn.com/aes/??tracker/1.0.34/index.js,tracker-plugin-pv/2.4.5/index.js,tracker-plugin-event/1.2.5/index.js,tracker-plugin-jserror/1.0.13/index.js,tracker-plugin-api/1.1.14/index.js,tracker-plugin-perf/1.1.8/index.js,tracker-plugin-eventTiming/1.0.4/index.js"></script>
<script src="//hm.baidu.com/hm.js?e3a5cec56ef8619cf9d7c2abebd509e3"></script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/nacos_colorful.png" alt="Nacos Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/nacos_colorful.png" alt="Nacos Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://nacos.io/zh-cn/docs/v2/quickstart/quick-start.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"> </a><a class="navbar__item navbar__link" href="/">Home</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="what-is-nacos" href="/docs/what-is-nacos">2.X</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/guide/user/faq">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/guide/user/faq">2.X</a></li><li><a class="dropdown__link" href="/docs/1.X/what-is-nacos">1.X</a></li></ul></div><a class="navbar__item navbar__link" href="/cloud">NACOS CLOUD</a><a href="https://developer.aliyun.com/ebook/36?spm=a2c6h.20345107.ebook-index.18.152c2984fsi5ST" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">E-BOOK-NACOS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/blog">BLOG</a><a class="navbar__item navbar__link" href="/community">COMMUNITY</a><a href="http://console.nacos.io/nacos/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DEMO-CONSOLE<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Default</a><ul class="dropdown__menu"><li><a href="/en/docs/guide/user/faq" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">En</a></li><li><a href="/zh-cn/docs/guide/user/faq" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-CN">中</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">What is Nacos</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/what-is-nacos">什么是 Nacos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts">Nacos 概念</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture">Nacos 架构</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Quick Start</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quickstart/quick-start">Nacos 快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quickstart/quick-start-docker">Nacos Docker 快速开始</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/quickstart/quick-start-kubernetes">Kubernetes Nacos</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Upgrading</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/upgrading/2.0.0-compatibility">Nacos 2.0.0 兼容性文档</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/upgrading/2.0.0-upgrading">Nacos 2.0 升级文档</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Plugin</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/auth-plugin">鉴权插件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/config-encryption-plugin">配置加密</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/datasource-plugin">多数据源</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/trace-plugin">轨迹追踪</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/custom-environment-plugin">自定义环境变量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/config-change-plugin">配置变更</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/plugin/control-plugin">反脆弱</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">User Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/sdk">Java SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/other-language">其他语言的SDK</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/open-api">Open API 指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/auth">Authorization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guide/user/faq">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/parameters-check">参数校验</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/user/failover">failover</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Admin Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/deployment">Nacos支持三种部署模式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/cluster-mode-quick-start">集群部署说明</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/system-configurations">Nacos系统参数介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/management-api">Management API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/console-guide">控制台手册</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/monitor-guide">Nacos 监控手册</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/nacos2-config-benchmark">Nacos2.0服务配置性能测试报告</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guide/admin/nacos2-naming-benchmark">Nacos2.0服务发现性能测试报告</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-sync">NacosSync 用户手册</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Ecology</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-with-dubbo">Dubbo 融合 Nacos 成为注册中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-with-spring">Nacos 融合 Spring，成为注册配置中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-with-spring-boot">Nacos 融合 Spring Boot，成为注册配置中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-with-spring-cloud">Nacos 融合 Spring Cloud，成为注册配置中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-sync">NacosSync 用户手册</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ecology/use-nacos-with-coredns">Nacos 融合CoreDNS 下发DNS域名</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Contributor Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribution/contributing">如何贡献</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribution/contributing-flow">贡献流程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribution/pull-request">提交需求模板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contribution/how-to-reporting-bugs">如何提交问题报告</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Community</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/community/">社区</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/community/nacos-dev">开发者</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">User Guide</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">FAQ</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.X</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>FAQ</h1><blockquote><p>文档优化中......</p></blockquote><ul><li><p>Nacos常规问题</p><ul><li><a href="#1.1">Nacos是什么</a></li><li><a href="#1.2">Nacos如何支持多环境</a></li><li><a href="#1.3">Nacos是否生产可用</a></li><li><a href="#1.4">Nacos有什么依赖</a></li><li><a href="#1.5">Nacos使用什么开源协议</a></li></ul></li><li><p>Nacos运维问题</p><ul><li><a href="#2.1">Nacos如何单机部署</a></li><li><a href="#2.2">Nacos单机部署如何使用Mysql</a></li><li><a href="#2.3">生产环境如何部署Nacos</a></li><li><a href="#2.4">Nacos如何Docker部署</a></li><li><a href="#2.5">如何在k8s中部署Nacos</a></li><li><a href="#2.6">如何监控Nacos</a></li><li><a href="#2.7">Nacos在Docker环境下集群部署，无法正常启动，日志一直打印 Nacos is starting...</a></li></ul></li><li><p>Nacos使用问题</p><ul><li><a href="#3.1">Zookeeper服务可以迁移到Nacos上吗</a></li><li><a href="#3.2">Nacos支持多配置文件</a></li><li><a href="#3.3">Nacos支持Dubbo</a></li><li><a href="#3.4">Nacos支持Spring体系</a></li><li><a href="#3.5">不使用Nacos SDK如何访问Nacos</a></li><li><a href="#3.6">Nacos对多语言的支持</a></li><li><a href="#3.7">Nacos0.8版本登陆失败</a></li><li><a href="#3.8">服务端报错<code>java.lang.IllegalStateException: unable to find local peer: 127.0.0.1:8848</code></a></li><li><a href="#3.9">Nacos如何对配置进行加密</a></li><li><a href="#3.10">Nacos报401错误</a></li><li><a href="#3.11">Nacos权重不生效</a></li><li><a href="#3.12">Nacos如何扩缩容</a></li><li><a href="#3.13">Nacos客户端修改日志级别</a></li><li><a href="#3.14">Nacos与Zipkin 整合出现<code>Service not found</code>问题</a></li><li><a href="#3.15">如何依赖最新的Nacos客户端？</a></li><li><a href="#3.16">客户端CPU高，或者内存耗尽的问题</a></li><li><a href="#3.17">日志打印频繁的问题</a></li><li><a href="#3.18">集群管理页面，raft term显示不一致问题</a></li><li><a href="#3.19">找不到符号<code>com.alibaba.nacos.consistency.entity</code></a></li><li><a href="#3.20">启动报错<code>the length of secret key must great than or equal 32 bytes...</code></a></li><li><a href="#3.20">启动报错<code>The specified key byte array is x bits ...</code></a></li></ul></li></ul><ul><li>Nacos原理问题</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos常规问题">Nacos常规问题<a href="#nacos常规问题" class="hash-link" aria-label="Direct link to Nacos常规问题" title="Direct link to Nacos常规问题">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1.1">Nacos是什么<a href="#1.1" class="hash-link" aria-label="Direct link to Nacos是什么" title="Direct link to Nacos是什么">​</a></h4><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。详情可以参考<a href="/docs/what-is-nacos">Nacos官网介绍</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1.2">Nacos如何支持多环境<a href="#1.2" class="hash-link" aria-label="Direct link to Nacos如何支持多环境" title="Direct link to Nacos如何支持多环境">​</a></h4><p>在日常使用中常常需要不同的环境，比如日常，预发，线上环境，如果是逻辑隔离可以使用命名空间，Nacos支持命名空间来支持多环境隔离，可以在Nacos控制台创建多个命名空间。如果需要物理隔离，就要部署多套Nacos环境。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1.3">Nacos是否生产可用<a href="#1.3" class="hash-link" aria-label="Direct link to Nacos是否生产可用" title="Direct link to Nacos是否生产可用">​</a></h4><p>Nacos在2019.1发布了Pre-GA版本，支持了安全隔离、监控和服务迁移等上生产的最后一公里，以更稳定的支撑用户的生产环境。详情可以参考<a href="https://www.oschina.net/news/104019/nacos-0-8-0-pre-ga" target="_blank" rel="noopener noreferrer">Nacos 发布 v0.8.0 Pre-GA 版本，安全稳定上生产</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1.4">Nacos有什么依赖<a href="#1.4" class="hash-link" aria-label="Direct link to Nacos有什么依赖" title="Direct link to Nacos有什么依赖">​</a></h4><p>在单机模式下，Nacos没有任何依赖，在集群模式下，Nacos依赖Mysql做存储，详情可以参考<a href="/docs/guide/admin/deployment">Nacos部署</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="1.5">Nacos使用什么开源协议<a href="#1.5" class="hash-link" aria-label="Direct link to Nacos使用什么开源协议" title="Direct link to Nacos使用什么开源协议">​</a></h4><p>Nacos使用<a href="https://github.com/alibaba/nacos/blob/master/LICENSE" target="_blank" rel="noopener noreferrer">Apache 2.0</a>。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos运维问题">Nacos运维问题<a href="#nacos运维问题" class="hash-link" aria-label="Direct link to Nacos运维问题" title="Direct link to Nacos运维问题">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.1">Nacos如何单机部署<a href="#2.1" class="hash-link" aria-label="Direct link to Nacos如何单机部署" title="Direct link to Nacos如何单机部署">​</a></h4><p>可以参考Nacos官网部署手册<a href="/docs/quickstart/quick-start">quick start</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.2">Nacos单机部署如何使用mysql<a href="#2.2" class="hash-link" aria-label="Direct link to Nacos单机部署如何使用mysql" title="Direct link to Nacos单机部署如何使用mysql">​</a></h4><p>Nacos单机模式默认使用内嵌的数据库作为存储引擎，如果想换成自己安装的mysql，可以按照<a href="/docs/guide/admin/deployment">官网文档</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.3">生产环境如何部署Nacos<a href="#2.3" class="hash-link" aria-label="Direct link to 生产环境如何部署Nacos" title="Direct link to 生产环境如何部署Nacos">​</a></h4><p>生产环境使用Nacos为了达到高可用不能使用单机模式，需要搭建nacos集群，具体详情可以参考<a href="/docs/guide/admin/cluster-mode-quick-start">集群部署手册</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.4">Nacos如何Docker部署<a href="#2.4" class="hash-link" aria-label="Direct link to Nacos如何Docker部署" title="Direct link to Nacos如何Docker部署">​</a></h4><p>除了使用压缩包部署Nacos，Nacos也提供了相应的Docker镜像，当Nacos发布新的版本的时候，Nacos会发布对应的镜像版本支持Docker部署。具体详情可以参考<a href="/docs/quickstart/quick-start-docker">Nacos Docker</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.5">如何在k8s中部署Nacos<a href="#2.5" class="hash-link" aria-label="Direct link to 如何在k8s中部署Nacos" title="Direct link to 如何在k8s中部署Nacos">​</a></h4><p>在生产环境部署Nacos集群，如果要对Nacos进行扩容操作，需要手动更改集群ip文件，启动新的Nacos服务。为了能进行自动化运维，Nacos和k8s结合利用StatefulSets提供了自动运维方案，能对Nacos进行动态扩缩容，具体详情参考<a href="https://github.com/nacos-group/nacos-k8s/blob/master/README-CN.md" target="_blank" rel="noopener noreferrer">Kubernetes Nacos</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.6">如何监控Nacos<a href="#2.6" class="hash-link" aria-label="Direct link to 如何监控Nacos" title="Direct link to 如何监控Nacos">​</a></h4><p>Nacos0.8版本提供了Metrics数据暴露能力，能通过Metrics数据的内容对Nacos的运行状态进行监控，详情参考<a href="/docs/guide/admin/monitor-guide">Nacos监控</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="2.7">Nacos在Docker环境下集群部署，无法正常启动，日志一直打印 Nacos is starting...<a href="#2.7" class="hash-link" aria-label="Direct link to Nacos在Docker环境下集群部署，无法正常启动，日志一直打印 Nacos is starting..." title="Direct link to Nacos在Docker环境下集群部署，无法正常启动，日志一直打印 Nacos is starting...">​</a></h4><p>原因可能是由于Docker环境下，内存不足导致另外的服务无法正常启动，最后导致服务报错，一直重启，可以通过增大Docker限制内存尝试解决。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos使用问题">Nacos使用问题<a href="#nacos使用问题" class="hash-link" aria-label="Direct link to Nacos使用问题" title="Direct link to Nacos使用问题">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.1">Zookeeper上的服务可以迁移到Nacos上吗<a href="#3.1" class="hash-link" aria-label="Direct link to Zookeeper上的服务可以迁移到Nacos上吗" title="Direct link to Zookeeper上的服务可以迁移到Nacos上吗">​</a></h4><p>可以通过Nacos-Sync把Zookeeper服务迁移到Nacos，也可以从Nacos迁移到Zookeeper，具体可以参考<a href="https://github.com/paderlol/nacos-sync-example" target="_blank" rel="noopener noreferrer">Nacos Sync 使用</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.2">Nacos支持多配置文件<a href="#3.2" class="hash-link" aria-label="Direct link to Nacos支持多配置文件" title="Direct link to Nacos支持多配置文件">​</a></h4><p>Nacos通过Spring Cloud Alibaba Nacos Config支持了多配置文件，可以将配置存储在多个独立的配置文件中。关联的<a href="https://github.com/alibaba/nacos/issues/320" target="_blank" rel="noopener noreferrer">issue</a>，详情参考文档<a href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba/wiki/Nacos-config" target="_blank" rel="noopener noreferrer">Spring Cloud Alibaba Nacos Config</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.3">Nacos支持Dubbo<a href="#3.3" class="hash-link" aria-label="Direct link to Nacos支持Dubbo" title="Direct link to Nacos支持Dubbo">​</a></h4><p>Nacos 0.6版本和Dubbo集成，支持使用Nacos作为注册中心，关联<a href="https://github.com/alibaba/nacos/issues/390" target="_blank" rel="noopener noreferrer">issue</a>,具体文档参考 <a href="/docs/ecology/use-nacos-with-dubbo">Dubbo 融合 Nacos 成为注册中心</a> 。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.4">Nacos支持Spring体系<a href="#3.4" class="hash-link" aria-label="Direct link to Nacos支持Spring体系" title="Direct link to Nacos支持Spring体系">​</a></h4><p>Nacos完善支持了Sping技术栈，具体可以参考<a href="/docs/ecology/use-nacos-with-spring">Nacos Spring</a>、<a href="/docs/ecology/use-nacos-with-spring-boot">Nacos Spring Boot</a>、<a href="/docs/ecology/use-nacos-with-spring-cloud">Spring Cloud</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.5">不使用Nacos SDK如何访问Nacos<a href="#3.5" class="hash-link" aria-label="Direct link to 不使用Nacos SDK如何访问Nacos" title="Direct link to 不使用Nacos SDK如何访问Nacos">​</a></h4><p>Nacos的网络交互都是基于Http协议实现的，提供了<a href="/docs/guide/user/open-api">Open-API</a>可以很容易实现Nacos的访问。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.6">Nacos对多语言的支持<a href="#3.6" class="hash-link" aria-label="Direct link to Nacos对多语言的支持" title="Direct link to Nacos对多语言的支持">​</a></h4><p>Nacos目前只支持Java，对于其他语言的支持还正在开发中，需要大家大力支持一起共建。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.7">Nacos0.8版本登陆失败<a href="#3.7" class="hash-link" aria-label="Direct link to Nacos0.8版本登陆失败" title="Direct link to Nacos0.8版本登陆失败">​</a></h4><p>Nacos 0.8版本当使用openjdk并且没有<code>JAVA_HOME</code>的环境变量时，nacos可以启动成功，是因为<code>yum install</code>安装的openjdk 会把java命令注册一份到<code>/bin</code>目录下面,所以会引发<code>SignatureException</code>异常。这个问题已经修复，0.9版本会发版，具体详情可以参考<a href="https://github.com/alibaba/nacos/issues/711" target="_blank" rel="noopener noreferrer">issue</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.8">服务端报错 java.lang.IllegalStateException: unable to find local peer: 127.0.0.1:8848<a href="#3.8" class="hash-link" aria-label="Direct link to 服务端报错 java.lang.IllegalStateException: unable to find local peer: 127.0.0.1:8848" title="Direct link to 服务端报错 java.lang.IllegalStateException: unable to find local peer: 127.0.0.1:8848">​</a></h4><p>这个问题是因为Nacos获取本机IP时,没有获取到正确的外部IP.需要保证<code>InetAddress.getLocalHost().getHostAddress()</code>或者<code>hostname -i</code>的结果是与cluster.conf里配置的IP是一致的。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.9">Nacos如何对配置进行加密<a href="#3.9" class="hash-link" aria-label="Direct link to Nacos如何对配置进行加密" title="Direct link to Nacos如何对配置进行加密">​</a></h4><p>Nacos计划在1.X版本提供加密的能力，目前还不支持加密，只能靠sdk做好了加密再存到nacos中。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.10">Nacos报401错误<a href="#3.10" class="hash-link" aria-label="Direct link to Nacos报401错误" title="Direct link to Nacos报401错误">​</a></h4><p>Nacos服务端报错了，可以检查服务端日志，参考<a href="https://github.com/alibaba/nacos/issues/816" target="_blank" rel="noopener noreferrer">issue</a>。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.11">Nacos权重不生效<a href="#3.11" class="hash-link" aria-label="Direct link to Nacos权重不生效" title="Direct link to Nacos权重不生效">​</a></h4><p>Nacos控制台上编辑权重, 目前从SpringCloud客户端和Dubbo客户端都没有打通, 所以不能生效. 对于SpringCloud客户端, 应用可以实现Ribbon的负载均衡器来进行权重过滤。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.12">Nacos如何扩缩容<a href="#3.12" class="hash-link" aria-label="Direct link to Nacos如何扩缩容" title="Direct link to Nacos如何扩缩容">​</a></h4><p>目前支持修改cluster.conf文件的方式进行扩缩容, 改完后无需重启, Server会自动刷新到文件新内容。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.13">Nacos客户端修改日志级别<a href="#3.13" class="hash-link" aria-label="Direct link to Nacos客户端修改日志级别" title="Direct link to Nacos客户端修改日志级别">​</a></h4><p>配置-D参数com.alibaba.nacos.naming.log.level设置naming客户端的日志级别，例如设置为error：
<code>-Dcom.alibaba.nacos.naming.log.level=error</code>
同样的，-D参数com.alibaba.nacos.config.log.level用来设置config客户端的日志级别。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.14">Nacos与Zipkin 整合出现 Service not found 问题<a href="#3.14" class="hash-link" aria-label="Direct link to Nacos与Zipkin 整合出现 Service not found 问题" title="Direct link to Nacos与Zipkin 整合出现 Service not found 问题">​</a></h4><p>配置<code>spring-cloud-seluth</code>参数：<code>spring.zipkin.discovery-client-enabled=false</code>。</p><p>如果仍然存在<code>Service not found</code>错误，则建议先使用open-api将Zipkin-server注册为永久实例服务：</p><p><code>curl -X POST &#x27;http://127.0.0.1:8848/nacos/v1/ns/instance?port=9411&amp;healthy=true&amp;ip=127.0.0.1&amp;weight=1.0&amp;serviceName=zipkin-server&amp;ephemeral=false&amp;namespaceId=public&#x27;</code></p><p>然后，前往nacos控制台，找到服务名为<code>zipkin-server</code>的服务，找到集群配置，设置健康检查模式为<code>TCP</code>，端口号为<code>9411</code>(即zipkin-server的端口)。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.15">如何依赖最新的Nacos客户端？<a href="#3.15" class="hash-link" aria-label="Direct link to 如何依赖最新的Nacos客户端？" title="Direct link to 如何依赖最新的Nacos客户端？">​</a></h4>很多用户都是通过Spring Cloud Alibaba或者Dubbo依赖的Nacos客户端，那么Spring Cloud Alibaba和Dubbo中依赖的Nacos客户端版本，往往会落后于Nacos最新发布的版本。在一些情况下，用户需要强制将Nacos客户端升级到最新，此时却往往不知道该升级哪个依赖，这里将Spring Cloud Alibaba和Dubbo的依赖升级说明如下：<h5 class="anchor anchorWithStickyNavbar_LWe7" id="spring-cloud-alibaba">Spring Cloud Alibaba<a href="#spring-cloud-alibaba" class="hash-link" aria-label="Direct link to Spring Cloud Alibaba" title="Direct link to Spring Cloud Alibaba">​</a></h5><p>用户通常是配置以下Maven依赖来使用的Nacos：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!--Nacos Discovery--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!--Nacos Config--&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-config</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这两个jar包实际上又依赖了以下的jar包：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">nacos-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[a particular version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果nacos-client升级了，对应的spring-cloud客户端版本不一定也同步升级，这个时候可以采用如下的方式强制升级nacos-client（以nacos-discovery为例）：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.cloud</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">spring-cloud-starter-alibaba-nacos-discovery</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">excludes</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">exclude</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                 </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">nacos-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">exclude</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">excludes</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">nacos-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="dubbo">Dubbo<a href="#dubbo" class="hash-link" aria-label="Direct link to Dubbo" title="Direct link to Dubbo">​</a></h5><p>Dubbo也是类似的道理，用户通常引入的是以下的依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">dubbo-registry-nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Dubbo dependency --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">dubbo</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>需要升级Nacos客户端时，只需要如下修改依赖：</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.alibaba.nacos</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">nacos-client</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">[latest version]</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.16">客户端CPU高，或者内存耗尽的问题<a href="#3.16" class="hash-link" aria-label="Direct link to 客户端CPU高，或者内存耗尽的问题" title="Direct link to 客户端CPU高，或者内存耗尽的问题">​</a></h4>问题的现象是依赖Nacos客户端的应用，在运行一段时间后出现CPU占用率高，内存占用高甚至内存溢出的现象，可以参考issue：[https://github.com/alibaba/nacos/issues/1605](https://github.com/alibaba/nacos/issues/1605)。这种情况首先要做的是分析CPU高或者内存占用高的原因，常用的命令有top、jstack、jmap、jhat等。其中一种情况是Nacos客户端实例在Spring Cloud Alibaba服务框架中被反复构造了多次，可以参考issue：[https://github.com/alibaba/spring-cloud-alibaba/issues/859](https://github.com/alibaba/spring-cloud-alibaba/issues/859)。这个问题已经得到了修复，预期会在下个Spring Cloud Alibaba版本中发布。<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.17">日志打印频繁的问题<a href="#3.17" class="hash-link" aria-label="Direct link to 日志打印频繁的问题" title="Direct link to 日志打印频繁的问题">​</a></h4>在老的Nacos版本中，往往会有大量的无效日志打印，这些日志的打印会迅速占用完用户的磁盘空间，同时也让有效日志难以查找。目前社区反馈的日志频繁打印主要有以下几种情况：<ol><li>access日志大量打印，相关issue有：<a href="https://github.com/alibaba/nacos/issues/1510" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos/issues/1510</a>。主要表现是{nacos.home}/logs/access_log.2019-xx-xx.log类似格式文件名的日志大量打印，而且还不能自动清理和滚动。这个日志是Spring Boot提供的tomcat访问日志打印，Spring Boot在关于该日志的选项中，没有最大保留天数或者日志大小控制的选项。因此这个日志的清理必须由应用新建crontab任务来完成，或者通过以下命令关闭日志的输出（在生产环境我们还是建议开启该日志，以便能够有第一现场的访问记录）：</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server.tomcat.accesslog.enabled=false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>服务端业务日志大量打印且无法动态调整日志级别。这个问题在1.1.3已经得到优化，可以通过API的方式来进行日志级别的调整，调整日志级别的方式如下：</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 调整naming模块的naming-raft.log的级别为error:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X PUT &#x27;$nacos_server:8848/nacos/v1/ns/operator/log?logName=naming-raft&amp;logLevel=error&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 调整config模块的config-dump.log的级别为warn:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -X PUT &#x27;$nacos_server:8848/nacos/v1/cs/ops/log?logName=config-dump&amp;logLevel=warn&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="3"><li>客户端日志大量打印，主要有心跳日志、轮询日志等。这个问题已经在1.1.3解决，请升级到1.1.3版本。</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.18">集群管理页面，raft term显示不一致问题<a href="#3.18" class="hash-link" aria-label="Direct link to 集群管理页面，raft term显示不一致问题" title="Direct link to 集群管理页面，raft term显示不一致问题">​</a></h4>在Nacos 1.0.1版本中，Nacos控制台支持了显示当前的集群各个机器的状态信息。这个功能受到比较多用户的关注，其中一个被反馈的问题是列表中每个节点的集群任期不一样。如下图所示（图片信息来自issue：https://github.com/alibaba/nacos/issues/1786）：<p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2019/png/333810/1567737322959-eed80457-e74c-4adb-bc29-6655860f8ca9.png#align=left&amp;display=inline&amp;height=279&amp;name=image.png&amp;originHeight=558&amp;originWidth=1685&amp;size=45557&amp;status=done&amp;width=842.5" alt="image.png" class="img_ev3q"></p><p>对于这个任期不一致的问题，原因主要是因为获取这个信息的逻辑有一些问题，没有从对应的节点上获取集群任期。这个问题会在下一个Nacos版本中修复。目前一个手动检查集群任期的办法是在每个节点上执行以下命令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl &#x27;127.0.0.1:8848/nacos/v1/ns/raft/state&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然后在返回信息中查找本节点的集群任期。因为每个节点返回的集群任期中，只有当前节点的信息是准确的，返回的其他节点的信息都是不准确的。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.19">找不到符号`com.alibaba.nacos.consistency.entity`<a href="#3.19" class="hash-link" aria-label="Direct link to 找不到符号`com.alibaba.nacos.consistency.entity`" title="Direct link to 找不到符号`com.alibaba.nacos.consistency.entity`">​</a></h4><p>这个包目录是由<code>protobuf</code>在编译时自动生成，您可以通过<code>mvn compile</code>来自动生成他们。如果您使用的是IDEA，也可以使用IDEA的protobuf插件。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.20">启动报错java.lang.IllegalArgumentException: the length of secret key must great than or equal 32 bytes...<a href="#3.20" class="hash-link" aria-label="Direct link to 启动报错java.lang.IllegalArgumentException: the length of secret key must great than or equal 32 bytes..." title="Direct link to 启动报错java.lang.IllegalArgumentException: the length of secret key must great than or equal 32 bytes...">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.21">启动报错java.lang.IllegalArgumentException: The specified key byte array is x bits which is not secure enough for any JWT HMAC-SHA algorithm.<a href="#3.21" class="hash-link" aria-label="Direct link to 启动报错java.lang.IllegalArgumentException: The specified key byte array is x bits which is not secure enough for any JWT HMAC-SHA algorithm." title="Direct link to 启动报错java.lang.IllegalArgumentException: The specified key byte array is x bits which is not secure enough for any JWT HMAC-SHA algorithm.">​</a></h4><p>默认鉴权插件需要密钥来生成访问token，密钥格式需要长度大于32。若<code>secret.key</code>进行BASE64解密后的长度小于32，则会在启动过程中此错误。
您可以在<code>application.properties</code>中设置正确的<code>secret.key</code>，详情见<a href="/docs/guide/user/auth">用户指南-权限认证</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3.22">启动报错Empty identity, Please set `nacos.core.auth.server.identity.key` and `nacos.core.auth.server.identity.value`<a href="#3.22" class="hash-link" aria-label="Direct link to 启动报错Empty identity, Please set `nacos.core.auth.server.identity.key` and `nacos.core.auth.server.identity.value`" title="Direct link to 启动报错Empty identity, Please set `nacos.core.auth.server.identity.key` and `nacos.core.auth.server.identity.value`">​</a></h4><p>2.2.1后的版本，移除了配置中间中<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>的默认值，并添加了启动校验。
如果在开启鉴权但未设置<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>的情况下，nacos server会提示以上报错信息，并阻止启动。
可查看<a href="/docs/guide/user/auth">用户指南-权限认证</a>文档中相关内容，进行设置后启动。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos原理问题">Nacos原理问题<a href="#nacos原理问题" class="hash-link" aria-label="Direct link to Nacos原理问题" title="Direct link to Nacos原理问题">​</a></h2></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guide/user/auth"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Authorization</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/guide/user/parameters-check"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">参数校验</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#nacos常规问题" class="table-of-contents__link toc-highlight">Nacos常规问题</a></li><li><a href="#nacos运维问题" class="table-of-contents__link toc-highlight">Nacos运维问题</a></li><li><a href="#nacos使用问题" class="table-of-contents__link toc-highlight">Nacos使用问题</a></li><li><a href="#nacos原理问题" class="table-of-contents__link toc-highlight">Nacos原理问题</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.121161b6.js"></script>
<script src="/assets/js/main.a6423de1.js"></script>
</body>
</html>