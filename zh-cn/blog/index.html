<!doctype html>
<html lang="zh-CN" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Blog | Nacos</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://nacos.io/zh-cn/img/nacos_colorful.png"><meta data-rh="true" name="twitter:image" content="https://nacos.io/zh-cn/img/nacos_colorful.png"><meta data-rh="true" property="og:url" content="https://nacos.io/zh-cn/blog"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="keywords" content="Nacos"><meta data-rh="true" property="og:title" content="Blog | Nacos"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="https://img.alicdn.com/tfs/TB1hgJpHAPoK1RjSZKbXXX1IXXa-64-64.png"><link data-rh="true" rel="canonical" href="https://nacos.io/zh-cn/blog"><link data-rh="true" rel="alternate" href="https://nacos.io/en/blog" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://nacos.io/zh-cn/blog" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://nacos.io/blog" hreflang="default"><link data-rh="true" rel="alternate" href="https://nacos.io/blog" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://1QV814950M-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/zh-cn/blog/rss.xml" title="Nacos RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-cn/blog/atom.xml" title="Nacos Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Nacos" href="/zh-cn/opensearch.xml">


<meta name="aes-config" content="pid=xux-opensource&amp;user_type=101&amp;uid=&amp;username=&amp;dim10=nacos">
<meta name="referrer" content="no-referrer">
<link rel="stylesheet" href="//g.alicdn.com/mamba/mse-arc-ui/0.0.21/umd/mse-arc-ui.min.css">
<script src="//g.alicdn.com/mamba/mse-arc-ui/0.0.21/umd/mse-arc-ui.min.js"></script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-0YDFJ7LX7F" async></script><link rel="stylesheet" href="/zh-cn/assets/css/styles.d254cbd7.css">
<link rel="preload" href="/zh-cn/assets/js/runtime~main.58d39aa6.js" as="script">
<link rel="preload" href="/zh-cn/assets/js/main.3a9d0c99.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>



<script src="//g.alicdn.com/alilog/mlog/aplus_v2.js" id="beacon-aplus" exparams="clog=o&amp;aplus&amp;sidx=aplusSidx&amp;ckx=aplusCkx"></script>
<script src="//g.alicdn.com/aes/??tracker/1.0.34/index.js,tracker-plugin-pv/2.4.5/index.js,tracker-plugin-event/1.2.5/index.js,tracker-plugin-jserror/1.0.13/index.js,tracker-plugin-api/1.1.14/index.js,tracker-plugin-perf/1.1.8/index.js,tracker-plugin-eventTiming/1.0.4/index.js"></script>
<script src="//hm.baidu.com/hm.js?e3a5cec56ef8619cf9d7c2abebd509e3"></script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="/zh-cn/img/nacos_colorful.png" alt="Nacos Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh-cn/img/nacos_colorful.png" alt="Nacos Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a href="https://nacos.io/zh-cn/docs/v2/quickstart/quick-start.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"> </a><a class="navbar__item navbar__link" href="/zh-cn/">首页</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" docid="/what-is-nacos" href="/zh-cn/docs/v2/what-is-nacos">2.X（推荐）</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-cn/docs/next/v2/what-is-nacos">用户文档</a></li><li><a class="dropdown__link" href="/zh-cn/docs/v2/what-is-nacos">2.X（推荐）</a></li><li><a class="dropdown__link" href="/zh-cn/docs/1.X/v2/what-is-nacos">1.X</a></li></ul></div><a class="navbar__item navbar__link" href="/zh-cn/cloud">Nacos Cloud</a><a href="https://developer.aliyun.com/ebook/36?spm=a2c6h.20345107.ebook-index.18.152c2984fsi5ST" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">NACOS架构与原理<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-cn/blog">博客</a><a class="navbar__item navbar__link" href="/zh-cn/community">社区</a><a href="http://console.nacos.io/nacos/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">控制台样例<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中</a><ul class="dropdown__menu"><li><a href="/en/blog" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">En</a></li><li><a href="/zh-cn/blog" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有文章</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.3.0-beta-release">Nacos 荣获GLCC优秀社区，同时2.3.0-BETA发布，欢迎试用</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/iscas2023">Nacos开源之夏2023，贡献社区赢取12000奖金</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.2.2-release">Nacos 2.2.2发布，优化启动体验和鉴权提示</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.2.1-release">Nacos 多个新版本发布，rust-sdk完全适配完成</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/announcement-token-secret-key">关于Nacos默认token.secret.key及server.identity风险说明及解决方案公告</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/higress">Higress + Nacos 微服务网关最佳实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-reigster-mechanism">Nacos 的一条注册请求会经历什么？</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.2.0-release">Nacos 2.2.0 版本发布，新增多种插件支持</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/212-and-220beta-release">Nacos 2.1.2、2.2.0-BETA及go-sdk 2.1.1 版本同时发布，多语言生态再添大将</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.1.1-release">Nacos 四周年，2.1.1 及 1.4.4 版本同时发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos3.0-is-coming">我们总结了3大使用建议，并首次公开 Nacos3.0 规划图 | Nacos 开源4周年</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/xiaomi-scale">小米Nacos2.0扩缩容最佳实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/iscas2022">Nacos开源之夏2022，贡献社区赢取12000奖金</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.1.0-release">Nacos 2.1.0版本发布，支持鉴权及加解密插件</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/use-nacos-with-rainbond">在 Rainbond 中一键安装高可用 Nacos 集群</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/apisix">Apache APISIX 基于 Nacos 实现服务发现</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/up-to-2w-star">双十一献礼 | Nacos Star破两万的回顾与展望</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.0.3-release">Nacos 2.0.3版本发布，继续提升集群稳定性及升级稳定性</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/performance-compare">Nacos 2.0 升级前后性能对比压测</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/springboot-0.2.10">Nacos-spring-boot0.2.10发布，全面支持Nacos2.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/iscas2021">Nacos 开源之夏2021活动 报名正式开启</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2.0.1-release">Nacos 2.0.1 + 1.4.2 Release</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/1.4.0-release">双十一购物节，Nacos 1.4.0 + Go SDK 1.0.1发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-distro-mechanism">Nacos 的 Distro 一致性协议</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/csharp-0.5.0">Nacos-sdk-csharp 0.5.0正式发布，功能与Java版本对齐！</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-2nd-anniversary">Nacos 两周年献礼，Nacos 1.3.2 + Go SDK 1.0.0发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/feeling-of-ASoC-2019">参与开源，Offer拿到手软 -- 来自一名2019阿里巴巴编程之夏同学的亲述</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos 1.2.0 guide">Nacos 1.2.0权限控制介绍和使用</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-1.3.0-design">Nacos 1.3.0 全新内核构建过程</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/namespace-endpoint-best-practices">Namespace,endpoint 最佳实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/pilot mcp">Pilot MCP协议介绍</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos 1.1.4">Nacos 1.1.4发布，业界率先支持Istio MCP协议</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-confd">Nacos整合Confd，支持nginx配置管理</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/eureka2">Eureka 2.0 开源工作宣告停止？别担心，ANS 即将 C位强势出道！</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos 1.1.0">Nacos 1.1.0发布，支持灰度配置和地址服务器模块</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-roadmap">Nacos GA后的整体规划</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/cmdb">Nacos打通CMDB实现就近访问</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/address-server">阿里巴巴基于 Nacos 实现环境隔离的实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos1.0.0">Nacos 1.0.0 发布，正式大规模生产可用</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos0.9.0">Nacos 0.9.0版本进行发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos0.9-intro">Nacos 0.9.0版本进行发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/huya-practice">虎牙直播在微服务改造方面的实践和总结</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos0.8">Nacos 0.8.0版本进行发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/huya-nacos">虎牙直播共建Nacos生态</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/5w1h-where">Nacos 有哪些典型的应用场景？—— 配置管理篇</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/dynamic-route-zuul-nacos">使用Nacos实现Spring Cloud Zuul的动态路由</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos0.6">Nacos 0.6版本发布，支持Dubbo生态并且支持Docker部署</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos0.5">Nacos0.5发布，支持DNS-based Service Discovery，JAVA 11</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos">Nacos 0.1.0 版本Review 活动设计</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/cncf">Nacos 进入CNCF landscape</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/5w1h-what">Nacos 帮我们解决什么问题？—— 配置管理篇</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/discovery-console">Nacos服务发现控制台预览</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/chengdu-dubbo">Nacos 计划发布v0.2版本，进一步融合Dubbo和SpringCloud生态</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/consul-k8s">Consul与kubernetes整合公告[翻译]</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/dns-sd">微服务架构中基于DNS的服务注册与发现</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos-is-coming">支持Dubbo生态发展，阿里巴巴启动新的开源项目 Nacos</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/alibaba-configserver">阿里巴巴服务注册中心产品ConfigServer 10年技术发展回顾</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Nacos 荣获GLCC优秀社区，同时2.3.0-BETA发布，欢迎试用"><meta itemprop="keywords" content="2.3.0"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/2.3.0-beta-release">Nacos 荣获GLCC优秀社区，同时2.3.0-BETA发布，欢迎试用</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-10-24T00:00:00.000Z" itemprop="datePublished">2023年10月24日</time> · <!-- -->阅读需 12 分钟</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="新版本发布">新版本发布<a href="#新版本发布" class="hash-link" aria-label="新版本发布的直接链接" title="新版本发布的直接链接">​</a></h2><p>经过4个多月社区的大量贡献，Nacos 2.3.0版本终于进入的Beta发布阶段，在经历了2.2.X的多个安全风险修复的版本后，又一次迎来了功能性上的更新版本。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-反脆弱插件">Nacos 反脆弱插件<a href="#nacos-反脆弱插件" class="hash-link" aria-label="Nacos 反脆弱插件的直接链接" title="Nacos 反脆弱插件的直接链接">​</a></h3><p>2.2.0版本加入ALPHA版本的反脆弱插件后，社区经过多次重构和修改，提升抽象度和稳定性，终于在2.3.0版本中正式公布了Nacos的反脆弱插件，用于避免Nacos集群在大量请求和连接时导致的容量问题而引发更大规模的故障。</p><p>默认反脆弱实现插件的使用以及自定义反脆弱插件的开发可参考文档<a href="https://nacos.io/zh-cn/docs/next/v2/plugin/control-plugin" target="_blank" rel="noopener noreferrer">反脆弱插件</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-配置变更插件">Nacos 配置变更插件<a href="#nacos-配置变更插件" class="hash-link" aria-label="Nacos 配置变更插件的直接链接" title="Nacos 配置变更插件的直接链接">​</a></h3><p>Nacos配置管理作为Nacos的核心功能，一直受到开发人员、运维人员和审计人员的关注，不少运维人员和审计人员向社区提出诉求，希望Nacos能够提供配置变更的审计、变更通知等功能；同时开发人员也希望Nacos提供一定的格式校验功能，避免修改配置时出现错误导致应用故障。</p><p>由于Nacos配置管理本身对配置内容是不感知的，且各个用户公司的审计、通知系统也各不相同，因此Nacos为了能够更广阔的适配各个用户的诉求，在去年的开源之夏中制定了配置变更插件的课题，希望以插件化的形式，来满足对配置变更过程的介入。</p><p>经过同学和导师长期的努力，该插件在2.3.0版本发布，用户可以开发自定义插件，在配置变更前和变更完成后，分别对接公司的审计系统和通知系统，并在变更前进行更多的校验操作，如格式校验，配置名字的规范化等。同时Nacos社区也提供了默认插件的实现，可接入webhook进行配置变更的通知以及导入配置的文件名校验等；详情可参考文档<a href="https://nacos.io/zh-cn/docs/next/v2/plugin/config-change-plugin" target="_blank" rel="noopener noreferrer">配置变更插件</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-请求参数校验">Nacos 请求参数校验<a href="#nacos-请求参数校验" class="hash-link" aria-label="Nacos 请求参数校验的直接链接" title="Nacos 请求参数校验的直接链接">​</a></h3><p>2.3.0版本之前的Nacos的参数校验逻辑分散，由各类请求的处理方法单独进行校验，难以更改维护，经常出现参数校验的遗漏，参数校验的规则也没有明确统一；这使得用户使用时经常会因为一些特殊字符导致功能不符合预期或出现漏洞，甚至导致大量推送，导致带宽打满，内存占用过多，导致应用出现故障。</p><p>在2.3.0版本中，Nacos明确了参数校验规则，在服务端实现了统一的参数校验逻辑并添加了参数校验层，根据校验规则对客户端向服务端发送的请求进行校验。用户可以选择开启参数校验功能，开启后Nacos将会对客户端向服务端发送的请求中的部分参数进行参数校验，确保参数的合法性，避免由于错误使用，导致的不符合预期以及性能问题。</p><p>详细情况可参考文档<a href="https://nacos.io/zh-cn/docs/next/v2/guide/user/parameters-check" target="_blank" rel="noopener noreferrer">参数校验规则</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-能力协商">Nacos 能力协商<a href="#nacos-能力协商" class="hash-link" aria-label="Nacos 能力协商的直接链接" title="Nacos 能力协商的直接链接">​</a></h3><p>随着Nacos功能越来越多，版本越来越多，客户端和服务端之间的兼容性愈发重要，如果继续保持尝试性的兼容，只会兼容能力愈发的困难。因此Nacos社区在去年开源之夏中，发布了课题，通过增加客户端和服务端之间的能力协商机制，在客户端连接到服务端时，让连接双方知道对方分别支持的功能，在支持对应功能的情况下，开启对应功能。避免通过尝试而增加通信开销。</p><p>在2.3.0版本中，该能力也被集成进来，为之后Nacos3.0支持更多优化功能提供基础。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="其他重要改动">其他重要改动<a href="#其他重要改动" class="hash-link" aria-label="其他重要改动的直接链接" title="其他重要改动的直接链接">​</a></h3><p>除了上述改动，Nacos2.3.0版本还支持了：客户端异常的metrics、grpc长连接的SSL功能、关闭开源控制台等功能，更多细节可以查看变更列表，欢迎试用：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> feature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#5698] Support nacos control plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8458] Support ability negotiations between server and clients.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8460] Support config change hook plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10117] Support metrics for nacos client request server exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10150] Support SSL for grpc connection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10223] Support auto build instance id when client request instance id is null.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10288] Support get more module state and switches in console.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10734] Support validate most of request parameters.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10774] Support toml format for configuration in console ui.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10831] Support batch deregister instances for service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10971] Support disable console ui and support add guide information.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement&amp;Refactor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#6819] Add page size selector in service details page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#8107</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9109</span><span class="token url" style="color:#36acaa">]</span><span class="token plain">[#10169][#10176] Enhance hint when console ui session expired for default auth plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9085] Add the Reachability Metadata required by native-image.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9821] Enhance datasource plugin to make more datasource implementation easier.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9881] Enhance configuration page to supports folding when editing configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10067] Enhance Windows compatibility for configuration snapshot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10155] Enhance hints for grpc request when request timeout.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10343] Use CMS as default GC when jdk less 9.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10361] Refactor module switches to make only load specified module but not only close in console ui.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10520] Validate for namespace show name when create new namespace.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10521] Enhance the hints for </span><span class="token code-snippet code keyword" style="color:#00009f">`No DataSourceSet`</span><span class="token plain"> error by validate datasource after construction.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10539] Enhance logs when opeation configuration failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10730] Link to v2 document for console ui.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10811] Enhance compatibility for colorful service healthy status in console ui.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10891] Support setting maximum number of push retries.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10930] Forward compatible old version secretKey for default auth plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11129] Remove the namespace information from the node list page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11231] Optimize the handleSpringBinder method in PropertiesUtil.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10056] Fix loss revision of client for distro sync.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10128] Fix wrong judgement in raft stateMachine.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10149] Fix dead lock on sending connection reset request on server over limit.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10271] Fix nacos-client failover switch file path.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10318] Fix import configuration problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10347] Fix only admin role user can register service into default namespace when enabled default auth plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10406] Fix jraft install leader snapshot error after disconnection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10427] Fix nacos client no response when handle server request with exception.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10464] Fix NPE when concurrent operations for client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10470] Fix some missed i18n for console ui.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10509] Fix out data connection not be disconnect problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10548] Fix switch domain might not load snapshot after restart.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10556] Fix index loss for client and service in extreme scenarios.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10583] Fix some new API loss auth check.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10585] Fix selectInstances and selectOneHealthyInstance methods will not subscribe service problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10593] Fix invalid create </span><span class="token code-snippet code keyword" style="color:#00009f">`file:`</span><span class="token plain"> dir under </span><span class="token code-snippet code keyword" style="color:#00009f">`nacos.home`</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10598] Fix nacos-client not random get server address when using address.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10606] Fix memory leak for nacos client when user create and shutdown client frequently.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10657] Fix NPE when using derby datasource for cluster mode.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10935] Fix startsWith judgement wrong when ignoreCase is true.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11056] Fix Batch register count size wrong, when batch register sereval time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11059] Fix RPC_CLIENT_TLS_PROTOCOLS setting error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11192] Fix batchRegisterInstance not recalculate revision prblem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11197] Fix frequent do query service when hit protect empty.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Dependency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7698] Remove httpasyncclient version dependency management to avoid version conflicts.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10416] Upgrade console yaml editor.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10648] Optimize Guava Dependency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10893] Upgrade spring boot to 2.7.15.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#11199] Upgrade grpc version to 1.57.2.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="开源之夏ospp-2023以及编程夏令营glcc-2023">开源之夏OSPP 2023以及编程夏令营GLCC 2023<a href="#开源之夏ospp-2023以及编程夏令营glcc-2023" class="hash-link" aria-label="开源之夏OSPP 2023以及编程夏令营GLCC 2023的直接链接" title="开源之夏OSPP 2023以及编程夏令营GLCC 2023的直接链接">​</a></h2><p>经过夏天如火如荼的努力，Nacos今年的开源之夏也接近尾声，各项目进展稳步推进，均取得了不小的进展。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="开源之夏-ospp-2023">开源之夏 OSPP 2023<a href="#开源之夏-ospp-2023" class="hash-link" aria-label="开源之夏 OSPP 2023的直接链接" title="开源之夏 OSPP 2023的直接链接">​</a></h3><p>Nacos在2023年度的<a href="https://summer-ospp.ac.cn/org/orgdetail/ab188e59-fab8-468f-bc89-bdc2bd8b5e64?lang=zh" target="_blank" rel="noopener noreferrer">开源之夏</a> 中，发布了9个项目，其中6个项目成功匹配同学，并基本完成了项目课题，其中不乏大量社区期待的新增功能和优化，将在后续版本中加入。</p><p>入选项目列表</p><ul><li>客户端订阅者合并和数据选择功能</li><li>为nacos-spring-boot-starter支持适配spring boot 3</li><li>ConfigMap到Nacos配置中心自动同步工具</li><li>客户端可观测性指标建设</li><li>支持Nacos注册中心的模糊订阅能力</li><li>实现其他部分xDS协议</li></ul><p>感谢导师和同学们的辛苦付出，也感谢主办方中科院软件所提供的优秀平台和活动。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-荣获编程夏令营-glcc-2023优秀社区">Nacos 荣获编程夏令营 GLCC 2023优秀社区<a href="#nacos-荣获编程夏令营-glcc-2023优秀社区" class="hash-link" aria-label="Nacos 荣获编程夏令营 GLCC 2023优秀社区的直接链接" title="Nacos 荣获编程夏令营 GLCC 2023优秀社区的直接链接">​</a></h3><p>Nacos在2023年度的<a href="https://www.gitlink.org.cn/glcc/2023/projects" target="_blank" rel="noopener noreferrer">编程夏令营</a> 申报了一个Nacos3.0中呼声较高的一个功能作为课题 -- 支持分布式锁。 目前已在导师和同学的共同努力下，初步完成了功能，预计会在Nacos3.0的Alpha版本中在社区公布。</p><p>由于导师和同学的努力，Nacos社区荣获CCF Gitlink 颁发的开源编程夏令营的优秀社区奖，感谢主办方Gitlink为社区提供的平台和活动。</p><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1698205859719-a59c31cf-153a-45dc-a9c5-e8859fc94a77.jpeg" alt="奖杯" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1698197100242-e440717c-80ec-4825-93c1-2daca1f289c4.jpeg#averageHue=%236664b2&amp;clientId=u14301240-344a-4&amp;from=drop&amp;id=ua9e02282&amp;originHeight=854&amp;originWidth=1280&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=204483&amp;status=done&amp;style=none&amp;taskId=u7637d2eb-a17e-431e-a637-231a61f9e96&amp;title=" alt="现场" class="img_ev3q"></th></tr></thead></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="展望">展望<a href="#展望" class="hash-link" aria-label="展望的直接链接" title="展望的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2x-后续计划">2.X 后续计划<a href="#2x-后续计划" class="hash-link" aria-label="2.X 后续计划的直接链接" title="2.X 后续计划的直接链接">​</a></h3><p>从2021年3月 2.0.0正式版发布至今，2.X版本已经走了接近2年时间，如今2.3.0版本发布，完成了大部分功能的插件化提炼，在之后的2.3.X版本中，会主要对当前版本的问题进行修复，并做出小范围的功能优化。同时对于2.4.0版本，会作为一个Nacos3.0的过度版本，对大量代码进行优化重构，在提升稳定性、健壮性的同时，提升易用性和可观测性，向Nacos3.0版本平稳过度。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="30-计划">3.0 计划<a href="#30-计划" class="hash-link" aria-label="3.0 计划的直接链接" title="3.0 计划的直接链接">​</a></h3><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a> 的畅想和规划，Nacos将会从统一控制面、支持国产化、存储计算分离等方向进一步演进Nacos的功能和架构，欢迎社区积极参与到新版本的建设中。</p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1698198629123-af9f1216-f996-4ac2-81bf-436048823d21.png" alt="image.png" class="img_ev3q"></p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=rUihF&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>最后欢迎大家扫码加入Nacos社区群</p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679276899363-83081d59-67c6-4501-9cf8-0d84ba7c6d7e.png#averageHue=%23c1c2c2&amp;clientId=u9dfeac18-3281-4&amp;from=paste&amp;height=551&amp;id=ubcf45e51&amp;name=image.png&amp;originHeight=1102&amp;originWidth=854&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=155261&amp;status=done&amp;style=none&amp;taskId=ud6bea1fe-b003-441b-a810-84435d2aeff&amp;title=&amp;width=427" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="欢迎在校同学们参与Nacos开源之夏，社区导师手把手让**你的代码被社会广泛复用，来赚取最高12000奖金，可**推荐入职/实习你心意公司，**又拿钱又成长又有价值**，你还等什么呢？报名马上截止，快来参与Nacos开源之夏。"><meta itemprop="keywords" content="Nacos,开源之夏，summerCode"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/iscas2023">Nacos开源之夏2023，贡献社区赢取12000奖金</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-05-11T00:00:00.000Z" itemprop="datePublished">2023年5月11日</time> · <!-- -->阅读需 8 分钟</div></header><div class="markdown" itemprop="articleBody"><p>欢迎在校同学们参与Nacos开源之夏，社区导师手把手让<strong>你的代码被社会广泛复用，来赚取最高12000奖金，可</strong>推荐入职/实习你心意公司，<strong>又拿钱又成长又有价值</strong>，你还等什么呢？报名马上截止，快来参与Nacos开源之夏。</p><h1>开源之夏是什么？</h1><p>开源之夏是由“开源软件供应链点亮计划”发起并长期支持的一项暑期开源活动，旨在鼓励<strong>在校学生</strong>积极参与开源软件的开发维护，促进优秀开源软件社区的蓬勃发展，培养和发掘更多优秀的开发者。
活动联合国内外各大开源社区，针对重要开源软件的开发与维护提供项目任务，并面向全球高校学生开放报名。
学生可在本活动中自主选择感兴趣的项目任务进行申请，并在中选后获得该开源项目资深维护者（社区导师）亲自指导的机会，完成项目并贡献给社区后，参与学生还将获得开源之夏<strong>活动奖金</strong>和<strong>结项证书</strong>。</p><h1>Nacos&amp;开源之夏2023</h1><p>Nacos被评为2021Github年度<strong>全国社区活跃度第六</strong>，Nacos开源产品定位是更易于构建云原生应用的动态服务发现、配置管理和服务管理平台，用云原生方式解决分布式领域核心问题。</p><p>自2018年孵化并开源以来，共收获<strong>26.3K的star</strong>数，<strong>11.7K的Fork</strong>数，在开源中国发布的 2021 年度 OSC 中国开源项目评选中，Nacos 被评为<strong>云原生领域人气指数 Top5 </strong>的项目、InfoQ 2022年度 <strong>十大开源新锐项目、</strong>2022开源项目成熟度评估<strong>优秀贰级</strong>，发布电子书《Nacos 架构与原理》<strong>14w+阅读</strong>，<strong>4w下载量</strong>，现已被大量微服务架构的软件公司选型作为其服务注册与发现中心。目前在国内服务注册中心及配置管理领域中<strong>市场占有率排名第一</strong>。</p><p>此次Nacos社区开放的题目中包含了Nacos第三代架构的部分核心功能模块，将直接参与社区的核心功能，欢迎进入Nacos开源之夏参与Nacos3.0的建设，为未来五年开源微服务发展奠定基础。</p><h1>参与Nacos开源之夏条件</h1><ul><li>本活动面向年满 18 周岁在校学生。</li><li>暑期即将毕业的学生，只要在申请时学生证处在有效期内，就可以提交申请。</li><li>中国籍学生参与活动需提供身份证、学生证、教育部学籍在线验证报告（学信网）或在读证明。</li><li>外籍学生参与活动需提供护照，同时提供录取通知书、学生卡、在读证明等文件用于证明学生身份。</li></ul><h1>参与Nacos开源之夏，你能获得什么？</h1><ol><li><strong>【你的代码被社会广泛复用】</strong> 你的代码可能会运行在上万家企业核心业务逻辑中，帮助企业解决问题。</li><li><strong>【赢得最高12000奖金】</strong> 奖金总额根据项目难度分为进阶 12000 元、基础 8000 元（注：奖金数额为税前人民币金额）</li><li><strong>【社区核心人员辅导快速成长】</strong> 只要你报名被选中，每个题目的导师会精心手把手教你融入社区，帮助你完成题目的设计以及最终的落地。</li><li><strong>【推荐入职/实习】</strong> 在本次编程之夏项目中表现优秀同学，可推荐入职/实习 你心意的公司工作。</li><li><strong>【额外获得社区礼包】</strong> 所有参与本次编程之夏项目的同学，均可获得Nacos社区大礼包。</li></ol><p><strong>百分百有奖品拿哦</strong>，现在唯一的问题是时间不多了，赶紧上车报名，截止报名时间是6月4日，6个核心题目，快点来报名参与Nacos编程之夏吧。</p><h1>课题&amp;报名方式</h1><p>点开Nacos开源之夏的<a href="https://summer-ospp.ac.cn/org/orgdetail/ab188e59-fab8-468f-bc89-bdc2bd8b5e64?lang=zh" target="_blank" rel="noopener noreferrer">链接</a> 选择你喜欢的题目，Nacos社区围绕Nacos第三代架构以及第二代架构中插件增强部分的题目，具体如下：</p><ul><li>新增达梦数据库插件实现</li><li>客户端订阅者合并和数据选择功能</li><li>为nacos-spring-boot-starter支持适配spring boot 3</li><li>ConfigMap到Nacos配置中心自动同步工具</li><li>客户端可观测性指标建设</li><li>支持Nacos注册中心的模糊订阅能力</li><li>提供分布式锁的能力</li><li>新增Nacos数据推送的反压机制</li><li>实现其他部分xDS协议</li></ul><p>具体流程请参考<a href="https://summer-ospp.ac.cn/help/student/" target="_blank" rel="noopener noreferrer">学生指南</a>。
请注意找导师沟通截止流程时间，优先更导师沟通，能帮助你更好的了解题目。
想要报名的同学，请用钉钉扫码加入Nacos开源之夏2023钉钉群，方便大家交流题目内容。
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1683769363444-5f586d83-388a-4609-974a-68a7b316e9de.png?x-oss-process=image%2Fresize%2Cw_993%2Climit_0" alt="image.png" class="img_ev3q"></p><h1>参考资料</h1><p>Nacos Github：<a href="https://github.com/alibaba/nacos" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/nacos</a></p><p>Nacos 官网：<a href="http://nacos.io" target="_blank" rel="noopener noreferrer">http://nacos.io</a></p><p>开源之夏官网：<a href="https://summer-ospp.ac.cn/org/orgdetail/ab188e59-fab8-468f-bc89-bdc2bd8b5e64?lang=zh" target="_blank" rel="noopener noreferrer">https://summer-ospp.ac.cn/org/orgdetail/ab188e59-fab8-468f-bc89-bdc2bd8b5e64?lang=zh</a></p><p>为了让同学们更好地了解Nacos，我们提供了<a href="https://www.yuque.com/nacos/ebook" target="_blank" rel="noopener noreferrer">电子书</a> 供大家阅读学习。
同时如果同学们对其他领域项目感兴趣，也可以尝试申请，例如：</p><ul><li>对于<strong>微服务分布式事务</strong>有兴趣的同学，可以尝试填报<a href="https://summer-ospp.ac.cn/org/orgdetail/064c15df-705c-483a-8fc8-02831370db14?lang=zh" target="_blank" rel="noopener noreferrer">Seata</a> 开源之夏；</li><li>对于<strong>微服务框架和RPC框架</strong>有兴趣的同学，可以尝试填报<a href="https://summer-ospp.ac.cn/org/orgdetail/41d68399-ed48-4d6d-9d4d-3ff4128dc132?lang=zh" target="_blank" rel="noopener noreferrer">Spring Cloud Alibaba</a> 和 <a href="https://summer-ospp.ac.cn/org/orgdetail/a7f6e2ad-4acc-47f8-9471-4e54b9a166a6?lang=zh" target="_blank" rel="noopener noreferrer">Dubbo</a> 开源之夏；</li><li>对于<strong>云原生网关</strong>有兴趣的同学，可以尝试填报<a href="https://higress.io/zh-cn/blog/ospp-2023" target="_blank" rel="noopener noreferrer">Higress</a> 开源之夏；</li><li>对于<strong>分布式高可用防护</strong>有兴趣的同学，可以尝试填报<a href="https://summer-ospp.ac.cn/org/orgdetail/5e879522-bd90-4a8b-bf8b-b11aea48626b?lang=zh" target="_blank" rel="noopener noreferrer">Sentinel</a> 开源之夏；</li><li>对于<strong>微服务治理</strong>有兴趣的同学，可以尝试填报<a href="https://summer-ospp.ac.cn/org/orgdetail/aaff4eec-11b1-4375-997d-5eea8f51762b?lang=zh" target="_blank" rel="noopener noreferrer">OpenSergo</a> 开源之夏。</li></ul></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Nacos 2.2.2发布，优化启动体验和鉴权提示"><meta itemprop="keywords" content="2.2.2,auth"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/2.2.2-release">Nacos 2.2.2发布，优化启动体验和鉴权提示</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-04-11T00:00:00.000Z" itemprop="datePublished">2023年4月11日</time> · <!-- -->阅读需 9 分钟</div></header><div class="markdown" itemprop="articleBody"><p>Nacos社区近期发布了2.2.0.1和2.2.1版本，对默认鉴权插件做出了较大的改动，详情查看<a href="https://nacos.io/zh-cn/blog/announcement-token-secret-key.html" target="_blank" rel="noopener noreferrer">风险说明</a>及<a href="https://nacos.io/zh-cn/blog/2.2.1-release.html" target="_blank" rel="noopener noreferrer">2.2.1发布</a>。
由于Nacos默认控制台ui中默认依赖了<code>token.secret.key</code>，所以在移除了<code>token.secret.key</code>的默认值后，许多新部署或默认使用latest版本镜像的用户出现大量启动失败的情况，对用户的易用性造成了较大影响。
因此2.2.2版本主要针对该问题进行了优化。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="新版本发布">新版本发布<a href="#新版本发布" class="hash-link" aria-label="新版本发布的直接链接" title="新版本发布的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-222">Nacos 2.2.2<a href="#nacos-222" class="hash-link" aria-label="Nacos 2.2.2的直接链接" title="Nacos 2.2.2的直接链接">​</a></h3><p>Nacos于2.2.0.1和2.2.1版本时移除了3个和鉴权有关的默认值，以避免用户部署时因各种原因未修改而引入的撞库风险。但其中<code>token.secret.key</code>在Nacos默认控制台ui的登陆页中被强制依赖，因此使得很多使用默认配置或对安全性要求不那么高的环境无法直接启动运行，给大量用户造成了使用困扰。</p><p>所以2.2.2版本的主要改动就是在<strong>未开启鉴权</strong>的情况下，通过取消默认控制台ui中的登录要求，从而移除对<code>token.secret.key</code>的强制依赖；在<strong>开启鉴权</strong>的情况下，用户仍然需要设置自定义的<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code>和 <code>nacos.core.auth.server.identity.value</code>。
否则将导致节点无法启动、登录失败、鉴权无法通过。</p><p>2.2.2 版本更多具体变更内容可参考变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement&amp;Refactor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10153] Close console login page when auth.enabled is false.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10276] Default close openssl for client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10208] Remove DefaultSettingPropertySource.java.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-go-sdk-221">Nacos-Go-SDK 2.2.1<a href="#nacos-go-sdk-221" class="hash-link" aria-label="Nacos-Go-SDK 2.2.1的直接链接" title="Nacos-Go-SDK 2.2.1的直接链接">​</a></h3><p>Nacos-Go-SDK 2.2.1 主要修复了2.2.0中一个错误的内存使用问题，同时也修复了其他的一些使用问题，更加稳定，欢迎使用。</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> update get cache config log print by @binbin0325 in #594</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> fixed memory usage problem caused by maxInt chan by @binbin0325 in #596</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> 调整 [INFO] logDir cacheDir 日志输出 by @Cotch22 in #590</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> 修复初始化并发读写的情况 by @tonglin96 in #591</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> grpc default port init by @binbin0325 in #598</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="社区">社区<a href="#社区" class="hash-link" aria-label="社区的直接链接" title="社区的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2022年度优秀贡献者">2022年度优秀贡献者<a href="#2022年度优秀贡献者" class="hash-link" aria-label="2022年度优秀贡献者的直接链接" title="2022年度优秀贡献者的直接链接">​</a></h3><p>Nacos社区在2022年获得诸多成就，离不开社区同学的积极参与和贡献。为了感谢2022年度积极参与Nacos社区和贡献代码的同学，Nacos社区在按照<a href="https://github.com/alibaba/nacos/graphs/contributors" target="_blank" rel="noopener noreferrer">github仓库贡献统计</a>和<a href="https://opensource.alibaba.com/contribution_leaderboard/details?projectValue=nacos&amp;timeType=month&amp;time=1677600000000" target="_blank" rel="noopener noreferrer">阿里巴巴开源贡献榜</a>，设置多个奖项，并附赠奖杯和礼品。</p><ul><li>贡献之星：在Nacos仓库统计和开源贡献榜中均有较高贡献的同学。<ul><li><a href="https://github.com/chenhao26-nineteen" target="_blank" rel="noopener noreferrer">chenhao26-nineteen</a>、<a href="https://github.com/li-xiao-shuang" target="_blank" rel="noopener noreferrer">li-xiao-shuang</a>、<a href="https://github.com/hujun-w-2" target="_blank" rel="noopener noreferrer">hujun-w-2</a></li></ul></li><li>生态之星：在Nacos的group生态仓库中有持续参与且做出杰出贡献的同学。<ul><li><a href="https://github.com/catcherwong" target="_blank" rel="noopener noreferrer">catcherwong</a>、<a href="https://github.com/czy88840616" target="_blank" rel="noopener noreferrer">czy88840616</a>、<a href="https://github.com/binbin0325" target="_blank" rel="noopener noreferrer">binbin0325</a>、<a href="https://github.com/paderlol" target="_blank" rel="noopener noreferrer">paderlol</a></li></ul></li><li>代码之星：在Nacos仓库中密集且长期持续性进行代码贡献的同学。<ul><li><a href="https://github.com/onewe" target="_blank" rel="noopener noreferrer">onewe</a>、<a href="https://github.com/CherishCai" target="_blank" rel="noopener noreferrer">CherishCai</a></li></ul></li><li>未来之星：在2022年度中，新加入Nacos社区，且有较大贡献的同学。<ul><li><a href="https://github.com/wuchubuzai2018" target="_blank" rel="noopener noreferrer">wuchubuzai2018</a>、<a href="https://github.com/Oliverwqcwrw" target="_blank" rel="noopener noreferrer">Oliverwqcwrw</a>、<a href="https://github.com/liqipeng" target="_blank" rel="noopener noreferrer">liqipeng</a>、<a href="https://github.com/The-Gamer-01" target="_blank" rel="noopener noreferrer">The-Gamer-01</a></li></ul></li><li>进步之星：在2022年前已经加入Nacos社区贡献，且在2022年度中贡献程度进步较大的同学。<ul><li><a href="https://github.com/YunWZ" target="_blank" rel="noopener noreferrer">YunWZ</a>、<a href="https://github.com/karsonto" target="_blank" rel="noopener noreferrer">karsonto</a></li></ul></li></ul><blockquote><p>说明：以上排名不分先后。</p></blockquote><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1680852964284-2443605d-d594-4dc8-bb75-6da14cdd8f12.jpeg#averageHue=%23a07b5e&amp;clientId=udb7e5972-f7b4-4&amp;from=paste&amp;height=437&amp;id=u6436f8f0&amp;name=IMG_3466.HEIC.JPG&amp;originHeight=874&amp;originWidth=1166&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=264073&amp;status=done&amp;style=none&amp;taskId=u7e0f0ab0-a69e-47b3-ad71-b1f016221bf&amp;title=&amp;width=583" alt="IMG_3466.HEIC.JPG" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1680852964324-f149c75c-b204-445c-a3b4-24aff8b79b5b.jpeg#averageHue=%23586c77&amp;clientId=udb7e5972-f7b4-4&amp;from=paste&amp;height=437&amp;id=uc7c2a34e&amp;name=IMG_1181.HEIC.JPG&amp;originHeight=874&amp;originWidth=1166&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=247482&amp;status=done&amp;style=none&amp;taskId=u7dfe30f4-5949-49b8-8a86-5d19ccd7324&amp;title=&amp;width=583" alt="IMG_1181.HEIC.JPG" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1680852987035-7bb5cad5-fbb1-4764-8383-19ddd22fb996.jpeg#averageHue=%23929990&amp;clientId=udb7e5972-f7b4-4&amp;from=paste&amp;height=477&amp;id=uea2c475d&amp;name=mmexport1680323559666.jpg&amp;originHeight=954&amp;originWidth=1279&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=114898&amp;status=done&amp;style=none&amp;taskId=ub2325bbf-d12c-4937-96d2-fd0261d93c3&amp;title=&amp;width=639.5" alt="mmexport1680323559666.jpg" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1681263310705-6a4bc1b0-b17a-4d46-9a82-597401cda18b.jpeg#averageHue=%23b59584&amp;clientId=u0dc24e80-8387-4&amp;from=drop&amp;id=u054e0974&amp;name=1426060892935891238.jpg&amp;originHeight=874&amp;originWidth=1166&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=211224&amp;status=done&amp;style=none&amp;taskId=uee90003b-75bd-4847-a2fa-29e5b7523e6&amp;title=" alt="1426060892935891238.jpg" class="img_ev3q"></th></tr></thead></table><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1681263479015-956f234c-10dd-4150-acb1-f5aed470bd3a.jpeg#averageHue=%239b9e97&amp;clientId=ua7179cf3-e42b-4&amp;from=drop&amp;id=u92c70cc9&amp;name=-785282054-1335766433.jpeg&amp;originHeight=1166&amp;originWidth=1166&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=904298&amp;status=done&amp;style=none&amp;taskId=u87fee435-af68-44d7-928e-4fb0610365e&amp;title=" alt="-785282054-1335766433.jpeg" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1681263583874-fc2c0b22-0d8f-405b-847a-c0c6076b8cb6.jpeg#averageHue=%23a7aaa3&amp;clientId=u61417e98-ccbb-4&amp;from=drop&amp;id=u3d14b102&amp;name=mmexport1680336390244.jpg&amp;originHeight=1780&amp;originWidth=1162&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=118932&amp;status=done&amp;style=none&amp;taskId=ua477518c-0ee2-4ba8-bd7a-461c4a3f0e9&amp;title=" alt="mmexport1680336390244.jpg" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1681263589035-47d7ba3c-615a-4b17-a76d-df8c9f01c441.jpeg#averageHue=%23c4c2b8&amp;clientId=u61417e98-ccbb-4&amp;from=drop&amp;id=u24a8e681&amp;name=mmexport1680339291530.jpg&amp;originHeight=2066&amp;originWidth=1162&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=447708&amp;status=done&amp;style=none&amp;taskId=u01e12f78-7602-4938-a19f-93e79692b42&amp;title=" alt="mmexport1680339291530.jpg" class="img_ev3q"></th></tr></thead></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="阿里巴巴开源开发者回馈计划">阿里巴巴开源开发者回馈计划<a href="#阿里巴巴开源开发者回馈计划" class="hash-link" aria-label="阿里巴巴开源开发者回馈计划的直接链接" title="阿里巴巴开源开发者回馈计划的直接链接">​</a></h3><p>阿里巴巴开源发起了开源开发者回馈计划，希望在合理量化开发者们的贡献的基础上，进一步给到实质性的回馈。该计划使用了 X-lab 开放实验室提出的 OpenRank 算法，即一种基于全域协作网络的算法去度量每位开发者的贡献。该算法从 2023 年 1 月起在阿里巴巴的 20 个重点项目上开始试运行。</p><p>此次，阿里巴巴开源统计了这 20 个项目中从 2023 年第一季度 <a href="https://opensource.alibaba.com/contribution_leaderboard/details?projectValue=nacos&amp;timeType=month&amp;time=1677600000000" target="_blank" rel="noopener noreferrer">OpenRank</a> 排名最高的 30 位社区外部贡献者，并寄出第一波礼品。</p><p>其中Nacos项目在2023 年第一季度的OpenRank中，有11位同学荣获第一波礼品，本次回馈计划的礼品非常豪华，是一把<strong>人体工学椅</strong>。其他参与社区贡献的同学也不要灰心，只要继续保持社区参与和贡献，依旧能得到下一次的大礼。</p><p>阿里巴巴开源将持续统计社区贡献者们在每个月上的 OpenRank 值，并作为积分不断累积，在未来，社区贡献者们可以通过积分兑换的形式获得更多礼品。我们相信，开源世界中的每一份贡献都值得回报！</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="开源之夏2023">开源之夏2023<a href="#开源之夏2023" class="hash-link" aria-label="开源之夏2023的直接链接" title="开源之夏2023的直接链接">​</a></h3><p>一年一度的<a href="https://summer-ospp.ac.cn/org/orgdetail/ab188e59-fab8-468f-bc89-bdc2bd8b5e64" target="_blank" rel="noopener noreferrer">开源之夏</a>如期而至，Nacos社区今年也积极参与，目前暂定的课题有：</p><ul><li><p>为Nacos适配Oracle数据库插件</p></li><li><p>为Nacos适配达梦数据库插件</p></li></ul><p>欢迎社区同学积极提供课题，尝试成为导师，想要提交新课题的同学请在Github中以issue的形式提交，格式为<code>[Proposal][Summer 2023]+课题名</code>，导师申请请在对应课题下回复评论并留下联系方式。</p><ul><li><p>提案新课题尽量以新增独立功能或模块为主，需要参与同学进行一定的设计和一定实现的代码量。</p></li><li><p>导师要求对课题相关Nacos源代码有一定的了解，并对课题的设计和实现方向有清晰的认知和把控。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="展望">展望<a href="#展望" class="hash-link" aria-label="展望的直接链接" title="展望的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2x-后续计划">2.X 后续计划<a href="#2x-后续计划" class="hash-link" aria-label="2.X 后续计划的直接链接" title="2.X 后续计划的直接链接">​</a></h3><p>从2021年3月 2.0.0正式版发布至今，2.X版本已经走了接近2年时间，如今2.2.1版本发布，说明2.X版本已经逐渐成熟稳定，在2.X的后续计划中，除了鼓励社区中提供和完善已有的插件多种实现以外，依旧会为其易用性和扩展性进一步增强，添加更多的插件功能：</p><ul><li>寻址插件</li><li>配置变更钩子插件</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="30-计划">3.0 计划<a href="#30-计划" class="hash-link" aria-label="3.0 计划的直接链接" title="3.0 计划的直接链接">​</a></h3><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a>的畅想和规划，Nacos将会从统一控制面、支持国产化、存储计算分离等方向进一步演进Nacos的功能和架构，欢迎社区积极参与到新版本的建设中。</p><p><img loading="lazy" alt="image.png" src="/zh-cn/assets/images/220-roadmap-4f6c43b09ff72f49d669db4d09a9634d.png" width="2308" height="792" class="img_ev3q">
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=rUihF&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>最后欢迎大家扫码加入Nacos社区群</p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679276899363-83081d59-67c6-4501-9cf8-0d84ba7c6d7e.png#averageHue=%23c1c2c2&amp;clientId=u9dfeac18-3281-4&amp;from=paste&amp;height=551&amp;id=ubcf45e51&amp;name=image.png&amp;originHeight=1102&amp;originWidth=854&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=155261&amp;status=done&amp;style=none&amp;taskId=ud6bea1fe-b003-441b-a810-84435d2aeff&amp;title=&amp;width=427" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Nacos 多个新版本发布，rust-sdk完全适配完成"><meta itemprop="keywords" content="2.2.1,rust-sdk"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/2.2.1-release">Nacos 多个新版本发布，rust-sdk完全适配完成</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-03-20T00:00:00.000Z" itemprop="datePublished">2023年3月20日</time> · <!-- -->阅读需 9 分钟</div></header><div class="markdown" itemprop="articleBody"><p>Nacos社区新年后好事不断，先是年初在电子标准院2022年度开源成熟度评估中被评为<code>优秀贰级</code>，同时获得了<code>CSDN年度开发者影响力项目</code>和<code>InfoQ 十大开源新锐项目</code>；随后又发布了许多新版本，其中包括Nacos 2.2.1、 1.4.5、rust-sdk 0.2.3 以及 go-sdk 2.2.0版本；在同学们的积极参与下，社区也是又增加了3位新的Committer。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="新版本发布">新版本发布<a href="#新版本发布" class="hash-link" aria-label="新版本发布的直接链接" title="新版本发布的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-221">Nacos 2.2.1<a href="#nacos-221" class="hash-link" aria-label="Nacos 2.2.1的直接链接" title="Nacos 2.2.1的直接链接">​</a></h3><p>Nacos 2.2.1版本主要针对Nacos社区于12月发布的2.2.0版本进行了一系列的升级以及修复，例如通过<a href="https://github.com/nacos-group/logback-adapter" target="_blank" rel="noopener noreferrer">logback-adapter</a>适配了新版本的logback、升级了grpc、jraft等依赖，从而升级了对应的netty和rocksdb版本，解决旧版本netty的安全漏洞和rocksdb对于ARM64、M1芯片架构的直接支持。
功能方面，新增一个Beta功能，支持Grpc的TLS功能，用户可在服务端和客户端分别加载CA文件，保证传输过程中的数据进行加密。</p><p>在客户端层面，新增了服务发现模块对Aliyun STS鉴权模式的支持，以及对GraalVM的支持。</p><p>插件方面，为多数据源插件添加了打印SQL的功能，方面插件开发者或使用者获得插件所生成的SQL，减少排查问题的时间；
同时对默认鉴权插件进行了一定重构，移除了对<code>jjwt</code>的依赖同时提升性能、移除<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>的默认值并提醒用户配置自定义的<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>以提高安全性，具体情况请查看<a href="https://nacos.io/zh-cn/blog/announcement-token-secret-key.html" target="_blank" rel="noopener noreferrer">风险公告</a>。</p><p>易用性方面，新增通过配置内容检索配置的功能，但该功能<strong>会损耗大量性能</strong>，因此从内部进行了限流，也请用户尽量避免使用。</p><p>2.2.1 版本更多具体变更内容可参考变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> feature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9276] Add search config by content.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9703] add catalog v2 API to support list instances which is un-enabled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9710] Support prometheus-sd basic auth.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9888] Beta support Grpc TLS feature.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10062] Naming support aliyun STS auth.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement&amp;Refactor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9510] Add sql log print function.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9646] Replace concatenated strings with placeholders.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9708] Clean expired and invalid connections for HTTP client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9783] Handle public namespaceId as default namespaceId for publish and query config for V2 http api.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9837] Enhance Grpc connected time when cluster started to load snapshot quickly.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9859] Refactor default auth plugin, use custom JWT instead of jjwt.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9860] Adapt logback 1.4.5 by SPI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9885] Add prometheus api exception handling.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9949] Use Grpc replace all Http request between servers.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9951] Judge the message whether </span><span class="token code-snippet code keyword" style="color:#00009f">`null`</span><span class="token plain"> for metadata processor.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10084] Client use Async appender to print log.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9621] Fix Config Client server check always up problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9728] Fix prometheus http sd only return public namespace problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9732] Fix namespace v2 api auth not work problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9734] Fix http login url without default port problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9795] Fix export config failure problem for non admin user after opening auth.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9816] Fix redo data is different from server when register and unregister service with concurrency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9819] Fix update password failure problem after use nginx.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9825] Fix config histroy page paged problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9861] Fix auth check before distro filter.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9862] Fix LDAP login failed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9943] Fix Config cas update can&#x27;t work when using derby database.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10014] Clear confused logic about namespace properties.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10038] Fix load failover file failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Dependency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#9504</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9767</span><span class="token url" style="color:#36acaa">]</span><span class="token plain"> Upgeade-spring-boot version to 2.6.14.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9789] Upgrade jraft version to 1.3.12.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9772] Upgrade Grpc version to 1.50.2.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9985] Replace flatten-maven-plugin with easyj-maven-plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10091] Upgrade snakeYaml to 2.0.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-145">Nacos 1.4.5<a href="#nacos-145" class="hash-link" aria-label="Nacos 1.4.5的直接链接" title="Nacos 1.4.5的直接链接">​</a></h3><p>Nacos 1.4.5版本基于1.4.4版本，将部分合并在2.X的问题和优化，同步到最新的1.X版本中，具体内容可查看变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> Enhancement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9064] Enhance error message and error code by merging #9045 and #8881 into v1.x.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#10089] Enhance STS auth for naming and async client log into v1.x.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#3720] Fix not admin user can change others password by api.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8979] Fix some ui problem by merging #8787、#8156 and #7364 into the v1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9020] Fix startup failed without prefix CUSTOM_SEARCH_LOCATIONS.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">#</span><span class="token title important"> Dependency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8541] Upgrade spring-boot version to 2.6.8.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-rust-sdk-023">Nacos-Rust-SDK 0.2.3<a href="#nacos-rust-sdk-023" class="hash-link" aria-label="Nacos-Rust-SDK 0.2.3的直接链接" title="Nacos-Rust-SDK 0.2.3的直接链接">​</a></h3><p>Nacos-Rust-SDK 在年前已经完成了对配置中心的功能适配， 经过社区同学的积极贡献，<a href="https://github.com/nacos-group/nacos-sdk-rust/releases/tag/v0.2.3" target="_blank" rel="noopener noreferrer">Nacos-Rust-SDK 0.2.3</a>版本终于完成了所有功能的适配，同时还能够绑定到nodejs中使用。欢迎正在使用rust的同学使用，并反馈意见。</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> enhance: add some debug log by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> chore: some logic optimization. by @CherishCai</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> add some unit tests by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> chore: Optimize and Unified code.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> ci: fix codecov tarpaulin with 0.22.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> chore: try exclude tls openssl by @CherishCai</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> [ISSUES #100] Change: naming api register_instance/select_instances by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> doc: link to nacos-sdk-rust-binding-node by @CherishCai</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> [ISSUES #102] fix naming changed service log by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> [ISSUES #101]  env cq count decrease to 1 by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> [ISSUES #107] Add asynchronous api by @onewe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> chore: upgrade version to 0.2.3 by @CherishCai</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-go-sdk-220">Nacos-Go-SDK 2.2.0<a href="#nacos-go-sdk-220" class="hash-link" aria-label="Nacos-Go-SDK 2.2.0的直接链接" title="Nacos-Go-SDK 2.2.0的直接链接">​</a></h3><p>Nacos-Go-SDK 2.2.0 支持了批量注册服务的<code>batchRegister</code>接口，同时修复了一些旧版本bug，具体内容可查看变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> config center support for disable local cache by @wangdongyun in #565</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> support batch register by @binbin0325 in #573</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> refine grpc_client by @binbin0325 in #574</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> fix MaxInt64 overflows on ARM 32-bits by @bavelee in #575</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> fix panic for rpc errorResponse by @binbin0325 in #577</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token list punctuation" style="color:#393A34">*</span><span class="token plain"> fix QueryInstancesOfService clusters by @binbin0325 in #578</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="社区">社区<a href="#社区" class="hash-link" aria-label="社区的直接链接" title="社区的直接链接">​</a></h2><p>感谢社区小伙伴的积极参与和厚爱，Nacos社区在2022年收获了电子标准院2022年度开源成熟度评估<code>优秀贰级</code>、<code>CSDN年度开发者影响力项目</code>和<code>InfoQ 十大开源新锐项目</code>等殊荣，在2023年也希望有更多的小伙伴参与到Nacos社区中，让Nacos越变越好</p><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679042599739-e7841f31-4f74-427c-a6b1-15100019212b.png#averageHue=%23b8b5ae&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=640&amp;id=u5c52e5b6&amp;name=image.png&amp;originHeight=1280&amp;originWidth=960&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=1848649&amp;status=done&amp;style=none&amp;taskId=u85c6ed43-3b8b-4c06-bf69-f6002f5df35&amp;title=&amp;width=480" alt="image.png" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679042600206-e0890689-ef18-4dd4-95b6-c3d84375d5d0.png#averageHue=%238088b2&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=640&amp;id=ubb66c1c4&amp;name=image.png&amp;originHeight=1280&amp;originWidth=960&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=2119680&amp;status=done&amp;style=none&amp;taskId=u83afbd7b-d79b-47c9-b23f-79921c8cb8a&amp;title=&amp;width=480" alt="image.png" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679042599053-6d168221-bc17-4d88-bfde-bf69375783f8.png#averageHue=%23908a7e&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=640&amp;id=uf2bd9bae&amp;name=image.png&amp;originHeight=1280&amp;originWidth=960&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=1304756&amp;status=done&amp;style=none&amp;taskId=u9421b95d-37ea-46f2-a439-790f5893431&amp;title=&amp;width=480" alt="image.png" class="img_ev3q"></th></tr></thead></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="新committer">新Committer<a href="#新committer" class="hash-link" aria-label="新Committer的直接链接" title="新Committer的直接链接">​</a></h3><p>社区中新增了3位Committer，他们分别为Nacos-K8s、Nacos-Rust-SDK、以及多数据源插件作出了巨大贡献。同时，Nacos社区也迎来了第一位来自开源之夏的Committer同学。</p><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679042674946-33a8223a-0d8b-4672-813a-322ecf4eb5f8.png#averageHue=%23accae6&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=1130&amp;id=ubdd03bac&amp;name=image.png&amp;originHeight=2260&amp;originWidth=1500&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=3916282&amp;status=done&amp;style=none&amp;taskId=u476b8ac5-e0eb-482b-bcd4-cd7a3255abb&amp;title=&amp;width=750" alt="image.png" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1679042628935-5dd6dc8f-6a49-495c-89dc-cc8e9501f8e8.jpeg#averageHue=%23a1cae8&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=1130&amp;id=udfc8027f&amp;name=%E8%94%A1%E9%B8%BF%E6%96%87-%20%E4%BA%BA%E7%89%A9%E6%B5%B7%E6%8A%A5.jpg&amp;originHeight=2260&amp;originWidth=1500&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=2541050&amp;status=done&amp;style=none&amp;taskId=ud5808db0-3ff5-4d00-a136-300aae3292a&amp;title=&amp;width=750" alt="蔡鸿文- 人物海报.jpg" class="img_ev3q"></th><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/jpeg/1577777/1679042632980-5d760b63-97b7-4197-aba9-ec37542270c3.jpeg#averageHue=%239ec8e9&amp;clientId=ue18ba04c-3f94-4&amp;from=paste&amp;height=1130&amp;id=uc26a01a1&amp;name=%E9%BB%84%E4%B9%99%E8%BD%A9-%E4%BA%BA%E7%89%A9%E6%B5%B7%E6%8A%A5.jpg&amp;originHeight=2260&amp;originWidth=1500&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=2403876&amp;status=done&amp;style=none&amp;taskId=uf56dc19e-f032-4192-ada9-70722bd91d9&amp;title=&amp;width=750" alt="黄乙轩-人物海报.jpg" class="img_ev3q"></th></tr></thead></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="展望">展望<a href="#展望" class="hash-link" aria-label="展望的直接链接" title="展望的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2x-后续计划">2.X 后续计划<a href="#2x-后续计划" class="hash-link" aria-label="2.X 后续计划的直接链接" title="2.X 后续计划的直接链接">​</a></h3><p>从2021年3月 2.0.0正式版发布至今，2.X版本已经走了接近2年时间，如今2.2.1版本发布，说明2.X版本已经逐渐成熟稳定，在2.X的后续计划中，除了鼓励社区中提供和完善已有的插件多种实现以外，依旧会为其易用性和扩展性进一步增强，添加更多的插件功能：</p><ul><li>寻址插件</li><li>配置变更钩子插件</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="30-计划">3.0 计划<a href="#30-计划" class="hash-link" aria-label="3.0 计划的直接链接" title="3.0 计划的直接链接">​</a></h3><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a>的畅想和规划，Nacos将会从统一控制面、支持国产化、存储计算分离等方向进一步演进Nacos的功能和架构，欢迎社区积极参与到新版本的建设中。</p><p><img loading="lazy" alt="image.png" src="/zh-cn/assets/images/220-roadmap-4f6c43b09ff72f49d669db4d09a9634d.png" width="2308" height="792" class="img_ev3q">
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=rUihF&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>最后欢迎大家扫码加入Nacos社区群</p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2023/png/1577777/1679276899363-83081d59-67c6-4501-9cf8-0d84ba7c6d7e.png#averageHue=%23c1c2c2&amp;clientId=u9dfeac18-3281-4&amp;from=paste&amp;height=551&amp;id=ubcf45e51&amp;name=image.png&amp;originHeight=1102&amp;originWidth=854&amp;originalType=binary&amp;ratio=2&amp;rotation=0&amp;showTitle=false&amp;size=155261&amp;status=done&amp;style=none&amp;taskId=ud6bea1fe-b003-441b-a810-84435d2aeff&amp;title=&amp;width=427" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="关于Nacos默认token.secret.key及server.identity风险说明及解决方案公告"><meta itemprop="keywords" content="nacos,auth,risk,token.secret.key,server.identity"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/announcement-token-secret-key">关于Nacos默认token.secret.key及server.identity风险说明及解决方案公告</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-03-02T00:00:00.000Z" itemprop="datePublished">2023年3月2日</time> · <!-- -->阅读需 5 分钟</div></header><div class="markdown" itemprop="articleBody"><p>近期Nacos社区收到关于Nacos鉴权功能通过<code>token.secret.key</code>默认值进行撞击，绕过身份验证安全漏洞的问题。社区在2.2.0.1和1.4.5版本已移除了自带的默认值，并在<code>token.secret.key</code>未传入或非法时阻止Nacos节点启动来提醒用户设置自定义<code>token.secret.key</code>。考虑到现在的控制台登陆页面并没有进行模块化，无法和是否开启鉴权功能关联，因此暂时需要强制设置<code>token.secret.key</code>，社区正在进行控制台登陆页面和鉴权功能的关联，待完成后，<strong>未开启鉴权</strong>的集群将不再强制需要<code>token.secret.key</code>，<strong>开启</strong>后仍然强制需要。</p><p>同时Nacos社区还收到关于通过<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>默认值进行撞击，绕过身份验证安全漏洞的问题。社区在2.2.1和1.4.5版本已移除了自带的默认值，并在开启鉴权后，未填写这两个参数时阻止Nacos节点启动来提醒用户设置自定义的<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>。</p><blockquote><p>说明：这两个默认值原意是为了方便新用户在快速搭建新集群进行使用时可以减少一些繁琐步骤，更简单的使用nacos，在实际部署时提供机制修改配置来提高安全性；随着社区用户对安全性要求提升，默认值可能会导致部分用户未修改直接使用时出现安全风险，因此Nacos社区去除了默认值，并在启动时进行校验，阻止启动提示用户配置。</p></blockquote><p>使用旧版本的用户请根据<a href="https://nacos.io/zh-cn/docs/v2/guide/user/auth.html" target="_blank" rel="noopener noreferrer">文档</a>进行环境检查，查看是否使用了默认的<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>，如仍然使用默认值，请参考文档内容尽快进行修改。</p><p>新部署环境请使用最新2.2.1版本部署，并根据文档设置<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>，并尽快修改默认密码。</p><p><a href="https://github.com/alibaba/nacos/releases/tag/2.2.1" target="_blank" rel="noopener noreferrer">Download page</a>.</p><h1>关于Nacos的部署建议</h1><p>Nacos 定义为一个应用服务发现和配置管理中间件服务，这类应用一般应该部署于<strong>内部网络环境</strong>，因此不建议用户将Nacos暴露在<strong>公网环境</strong>。</p><p>同时应开启鉴权，设置自定义<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>，并修改<code>nacos</code>用户的密码，提高安全性。</p><p>另外，即使升级到最新版本，开启鉴权并修改了<code>token.secret.key</code>、<code>nacos.core.auth.server.identity.key</code>、<code>nacos.core.auth.server.identity.value</code>和<code>nacos</code>用户的密码，也请不要暴露在<strong>公网环境</strong>使用。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于变更tokensecretkey对正在运行程序的影响及初步解决方式">关于变更token.secret.key对正在运行程序的影响及初步解决方式<a href="#关于变更tokensecretkey对正在运行程序的影响及初步解决方式" class="hash-link" aria-label="关于变更token.secret.key对正在运行程序的影响及初步解决方式的直接链接" title="关于变更token.secret.key对正在运行程序的影响及初步解决方式的直接链接">​</a></h2><p>修改<code>token.secret.key</code>并重启Nacos Server端后，来自Nacos Client的请求将会因无效token被拒绝。直到客户端到达旧token的TTL时间后，才会重新去获取新token。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="解决方式">解决方式<a href="#解决方式" class="hash-link" aria-label="解决方式的直接链接" title="解决方式的直接链接">​</a></h3><p>目前该问题的解决有一个关联<a href="https://github.com/alibaba/nacos/issues/10105" target="_blank" rel="noopener noreferrer">ISSUE</a>，欢迎大家进入讨论。</p><p>在修改<code>token.secret.key</code>前，先修改<code>token.expire.seconds</code>为5，客户端默认<code>每5s</code>检查一次token是否过期，需要让客户端尽快过期掉旧token。</p><div class="language-properties codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-properties codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 2.1.0版本前</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nacos.core.auth.default.token.expire.seconds=5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 2.1.0版本及更高版本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nacos.core.auth.plugin.nacos.token.expire.seconds=5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改<code>token.expire.seconds</code>后重启集群，运行一段时间（超过原<code>token.expire.seconds</code>值，以保证所有客户端已经获取到新TTL）</p><blockquote><p>注意：修改后会导致客户端较为频繁地调用login接口，修改前请确保Nacos Server集群的资源足够。</p></blockquote><p>最后将<code>token.secret.key</code>修改为新值，并重启集群，<code>token.expire.seconds</code>值请酌情修改。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于变更nacoscoreauthserveridentitykey-和-nacoscoreauthserveridentityvalue对正在运行程序的影响">关于变更<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>对正在运行程序的影响<a href="#关于变更nacoscoreauthserveridentitykey-和-nacoscoreauthserveridentityvalue对正在运行程序的影响" class="hash-link" aria-label="关于变更nacoscoreauthserveridentitykey-和-nacoscoreauthserveridentityvalue对正在运行程序的影响的直接链接" title="关于变更nacoscoreauthserveridentitykey-和-nacoscoreauthserveridentityvalue对正在运行程序的影响的直接链接">​</a></h2><p>修改<code>nacos.core.auth.server.identity.key</code> 和 <code>nacos.core.auth.server.identity.value</code>不会对当前正在运行造成影响，但可能会导致变更同步失败或自动摘除实例失败。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="解决方式-1">解决方式<a href="#解决方式-1" class="hash-link" aria-label="解决方式的直接链接" title="解决方式的直接链接">​</a></h3><p>按照<a href="https://nacos.io/zh-cn/docs/v2/guide/user/auth.html" target="_blank" rel="noopener noreferrer">文档</a>提示，先开启userAgent白名单，在变更新<code>server.identity</code>后，立刻关闭userAgent白名单。</p><p>或保证变更<code>server.identity</code>期间，不进行业务应用的变更。</p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Higress：Nacos的最佳拍档"><meta itemprop="keywords" content="higress,higress nacos"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/higress">Higress + Nacos 微服务网关最佳实践</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-10T00:00:00.000Z" itemprop="datePublished">2023年1月10日</time> · <!-- -->阅读需 14 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">澄潭</span></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>在去年11月的云栖大会上，我们开源了云原生网关 Higress，时隔 2 月，Higress 的 Github 项目(<a href="https://github.com/alibaba/higress" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/higress</a>)已经收获了 700+ star，以及大量社区小伙伴的关注。在社区的交流中我们发现有不少微服务开发者在使用如 Spring Cloud Gateway/Zuul 等微服务网关对接 Nacos 注册中心实现微服务的路由，并且希望了解迁移到 Higress 网关能带来哪些好处。
本文将介绍 Higress 组合 Nacos 作为微服务网关能力，并介绍微服务网关发展的两个趋势，为网关的选型指明道路：</p><ul><li>趋势一：统一 API 标准，向云原生微服务架构演进</li><li>趋势二：合并安全&amp;流量网关，向 DevSecOps 演进</li></ul><h1>Higress：Nacos的最佳拍档</h1><p><img loading="lazy" src="https://img.alicdn.com/imgextra/i2/O1CN01Ww9gDw1PwXJUlwwRy_!!6000000001905-2-tps-1200-475.png" alt="image.png" class="img_ev3q">
Higress 和 Nacos 其实是师出同门——阿里中间件团队。在 Higress 支撑阿里内部业务的阶段，Higress 就已经搭配 Nacos 作为微服务网关使用，凭借高性能支撑了双十一的洪峰流量；到了云产品商业化阶段，Higress 和 Nacos 继续基于阿里云 MSE（Microservices Engine）产品，紧密协作演进产品功能；Higress 开源之后，如果想要自建微服务网关，选择 Higress 配合 Nacos 使用，具备以下优势：</p><ol><li>对比 Spring Cloud Gateway/Zuul 等传统 Java 微服务网关性能高出 2-4 倍，可以显著降低资源成本</li><li>作为云原生网关，实现了 Ingress/Gateway API 标准，兼容 Nginx Ingress 大部分注解，支持业务渐进式向基于 K8s 的微服务架构演进</li><li>与 Dubbo/OpenSergo/Sentinel 等开源微服务生态深度整合，提供最佳实践</li></ol><p>这里默认已经安装好 Higress，搭配 Nacos 使用的具体方式如下：</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置服务来源">配置服务来源<a href="#配置服务来源" class="hash-link" aria-label="配置服务来源的直接链接" title="配置服务来源的直接链接">​</a></h2><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.higress.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> McpBridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> higress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">registries</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 定义一个名为 “production” 的服务来源</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心类型是 Nacos 2.x，支持 gRPC 协议</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nacos2  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心的访问地址，可以是域名或者IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">domain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.xxx.xx.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心的访问端口，Nacos 默认都是 8848</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8848</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Nacos 命名空间 ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacosNamespaceId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> d8ac64f3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">47a814ecf358    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Nacos 服务分组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacosGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DEFAULT_GROUP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 定义一个名为 “uat” 的服务来源</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> uat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心类型是 Nacos 1.x，只支持 HTTP 协议</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nacos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心的访问地址，可以是域名或者IP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">domain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 192.xxx.xx.31</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 注册中心的访问端口，Nacos 默认都是 8848</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8848</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Nacos 命名空间 ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacosNamespaceId</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 98ac6df3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ab98115dfde4    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Nacos 服务分组</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nacosGroups</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> DEFAULT_GROUP    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我们通过 McpBridge 资源配置了两个服务来源，分别取名 “production”和“uat”，需要注意的是 Higress 对接 Nacos 同时支持 HTTP 和 gRPC 两种协议，建议将 Nacos 升级到 2.x 版本，这样可以在上述配置的 type 中指定 “nacos2” 使用 gRPC 协议，从而更快速地感知到服务变化，并消耗更少的 Nacos 服务端资源。
基于 McpBridge 中的 registries 数组配置，Higress 可以轻松对接多个且不同类型的服务来源（Nacos/Zookeeper/Eureka/Consul/...），这里对于 Nacos 类型的服务来源，支持配置多个不同命名空间，从而实现不同命名空间的微服务可以共用一个网关，降低自建微服务网关的资源成本开销。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="配置-ingress">配置 Ingress<a href="#配置-ingress" class="hash-link" aria-label="配置 Ingress的直接链接" title="配置 Ingress的直接链接">​</a></h2><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">higress.io/destination</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">provider.DEFAULT</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">GROUP.d8ac64f3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">47a814ecf358.nacos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.higress.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> McpBridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pathType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Prefix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>和常见的 Ingress 在 backend 中定义 service 不同，这里基于 Ingress 的 resource backend 将上面定义服务来源的 McpBridge 进行关联。并通过注解<code>higress.io/destination</code>指定路由最终要转发到的目标服务。对于 Nacos 来源的服务，这里的目标服务格式为：“服务名称.服务分组.命名空间ID.nacos”，注意这里需要遵循 DNS 域名格式，因此服务分组中的下划线&#x27;_&#x27;被转换成了横杠&#x27;-&#x27;。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="丰富的微服务网关能力">丰富的微服务网关能力<a href="#丰富的微服务网关能力" class="hash-link" aria-label="丰富的微服务网关能力的直接链接" title="丰富的微服务网关能力的直接链接">​</a></h2><p>Higress 在微服务发现的基础上，提供了多种实用的微服务网关能力，这里以“灰度发布”和“自定义扩展”进行举例，更多能力可以点击原文参考 Higress 官网文档进行了解。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="灰度发布">灰度发布<a href="#灰度发布" class="hash-link" aria-label="灰度发布的直接链接" title="灰度发布的直接链接">​</a></h3><p>Higress 完全兼容了 Nginx Ingress 的金丝雀（Canary）相关注解，如下所示，可以将带有HTTP Header为x-user-id: 100的请求流量路由到灰度服务中。</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.k8s.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Ingress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">higress.io/destination</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> service</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">provider.DEFAULT</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">GROUP.98ac6df3</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">xxxx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">ab98115dfde4.nacos</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nginx.ingress.kubernetes.io/canary</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nginx.ingress.kubernetes.io/canary-by-header</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">user</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">nginx.ingress.kubernetes.io/canary-by-header-value</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;100&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">uat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">rules</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">paths</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resource</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">apiGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> networking.higress.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> McpBridge</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">pathType</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Prefix</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>您还可以基于 OpenKruise Rollout 让灰度发布和服务部署过程联动，从而实现渐进式交付，具体可以参考这篇文章<a href="https://mp.weixin.qq.com/s/vqwAUITNq9_twYHWX_5ZDg" target="_blank" rel="noopener noreferrer">《Higress &amp; Kruise Rollout: 渐进式交付为应用发布保驾护航》</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="自定义扩展">自定义扩展<a href="#自定义扩展" class="hash-link" aria-label="自定义扩展的直接链接" title="自定义扩展的直接链接">​</a></h3><p>作为微服务网关，需要在微服务架构中承担部分通用逻辑的处理，例如认证鉴权，安全防护等。通用的逻辑无法满足多样性的业务场景，Higress 可以支持开发者添加自定义处理逻辑。与 Spring Cloud Gateway 等传统微服务网关需要开发者自己在 Gateway 代码中加 Filter 不同，Higress 支持开发者使用多种语言编写 Wasm 插件，并动态加载生效，插件生效过程无需重启网关，变更插件逻辑对流量完全无损。
下例是一个屏蔽特定请求的 Wasm 插件，当请求 url 中出现 “swagger.html” 时将被直接拒绝访问，插件实现代码参考：<a href="https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/request-block" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/higress/tree/main/plugins/wasm-go/extensions/request-block</a></p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> extensions.istio.io/v1alpha1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> WasmPlugin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> request</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> higress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">matchLabels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">higress</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> higress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">higress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">gateway</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">pluginConfig</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">block_urls</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;swagger.html&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">url</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> oci</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//higress</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">registry.cn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">hangzhou.cr.aliyuncs.com/plugins/request</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.0.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wasm 插件的开发&amp;编译&amp;镜像推送方式可以参考这篇文章<a href="https://mp.weixin.qq.com/s/eoPlaOgRm7u5wJAxhbVGGg" target="_blank" rel="noopener noreferrer">《Higress 实战：30 行代码写一个 Wasm Go插件》</a></p><h1>微服务网关发展趋势</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="趋势一统一-api-标准向云原生微服务架构演进">趋势一：统一 API 标准，向云原生微服务架构演进<a href="#趋势一统一-api-标准向云原生微服务架构演进" class="hash-link" aria-label="趋势一：统一 API 标准，向云原生微服务架构演进的直接链接" title="趋势一：统一 API 标准，向云原生微服务架构演进的直接链接">​</a></h2><p>基于一套 API 可以有不同的实现，既让用户不被具体实现锁定，又桥接了技术演进的鸿沟。API 可以说是整个云原生架构的基石，或许有一天 K8s 会消失，但是面向抽象的 API 标准定会长存。在流量网关领域，Ingress API 已经成为标准。而对于微服务网关等更复杂的使用场景，Ingress 受限于其简单的协议字段，需要通过 Ingress 注解等方式进行能力扩展，难以被标准化。因此诸如 Contour、Emissary、Kong、APISIX 等都定义了自己的 HTTP 路由等 CRD，网关的 API 定义开始呈现碎片化。
这一背景之下，Gateway API 应运而生，并且在过去的一年里从 alpha 演进到了 beta 阶段。虽然目前 Gateway API 还未定稿，协议仍会发生变动，不建议用于生产，但 API 统一趋势已经不可阻挡，只是时间的问题。下图是 Gateway API 的一个用例场景，不同于 Ingress API，将集群运维和业务运维的职责进行了划分，这样业务开发人员不再需要关心网站证书等集群级的细节，只专注于业务本身的 DevOps，集群运维任务可以交给 SRE 人员进行统一处理。
<img loading="lazy" src="https://img.alicdn.com/imgextra/i3/O1CN01jDsDrv1zaqj82YkYP_!!6000000006731-2-tps-2735-1519.png" alt="image.png" class="img_ev3q">
Higress 目前采用 Ingress 注解的能力来实现能力扩展，并兼容了 Nginx Ingress 大部分常用注解，且具备平滑迁移到 Gateway API 的能力。
Higress 为传统微服务架构，提供了渐进式的方式，向基于 K8s 的云原生微服务架构演进：可以通过 Nacos 发现部署在 K8s 之外的服务，从而实现了网关后端微服务可以和 K8s 解耦，业务团队可以将微服务逐个迁移至 K8s，而不用担心网关层的流量影响。
从传统微服务网关迁移到 Higress，再渐进式完成整个微服务架构的云原生化，是一个明智的选择。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="趋势二合并安全流量网关向-devsecops-演进">趋势二：合并安全&amp;流量网关，向 DevSecOps 演进<a href="#趋势二合并安全流量网关向-devsecops-演进" class="hash-link" aria-label="趋势二：合并安全&amp;流量网关，向 DevSecOps 演进的直接链接" title="趋势二：合并安全&amp;流量网关，向 DevSecOps 演进的直接链接">​</a></h2><p>Higress 提出了将安全、流量、微服务网关三合一的概念，首先来看一个典型的多层网关架构：
<img loading="lazy" src="https://img.alicdn.com/imgextra/i2/O1CN0178hdNj25QDDnqmISC_!!6000000007520-2-tps-1318-198.png" class="img_ev3q">
在这个架构中，用 WAF 网关实现安全能力，Ingress 网关实现集群入口网关能力（非 K8s 场景或会部署一层 Nginx），SCG（Spring Cloud Gateway） 实现微服务网关能力。这样的架构下，需要对每一层网关都进行容量评估，每一层网关都是潜在的瓶颈点，都可能需要进行扩容。这样造成的资源成本和运维人力成本都是巨大的。并且每多一层网关，就多一层可用性风险。一旦出现可用性问题，多层网关会导致问题定位复杂度显著上升，对应的平均故障恢复时间（MTTR）将大幅增加。
<img loading="lazy" src="https://img.alicdn.com/imgextra/i1/O1CN01BnAVqH1SCE73I5l85_!!6000000002210-2-tps-1318-198.png" class="img_ev3q">
采用三合一的架构中，可以显著降低成本，并提高系统整体可用性。同时这也符合 DevSecOps 的微服务演进趋势，微服务开发者可以更多地从业务接口视角关注安全性，而不是采用所有路由一刀切的 WAF 防护模式。
技术架构演进的背后是组织架构演进，这也是微服务 DevOps 一直在强调的，要围绕开发者为核心，从而提升微服务开发效率。向 DevSecOps 演进并没有捷径，依然需要开发角色和运维角色之间的双向奔赴，打破传统开发与运维之间的壁垒，形成从开发、部署、安全运营这样一个全功能化的敏捷团队。
通过 Higress 将网关合并作为向 DevSecOps 演进的抓手，是一个明智的选择。</p><h1>参与 Higress 社区</h1><p>Higress 开源贡献小组正在火热招募贡献者。如果您有时间，有热情，有意愿，欢迎联系社区加入开源贡献小组，一起共同完善 Higress，一起主导下一代云原生网关的设计和实现。
社区官网（点击“阅读原文”跳转）: <a href="https://higress.io" target="_blank" rel="noopener noreferrer">https://higress.io</a>
社区开发者群：
<img loading="lazy" src="https://img.alicdn.com/imgextra/i1/O1CN01Zc7yGt1p0zYq3OCwj_!!6000000005299-2-tps-979-1280.png" alt="image.png" class="img_ev3q">
社区交流群：
<img loading="lazy" src="https://img.alicdn.com/imgextra/i2/O1CN01Ebh7P021yKGBaP35B_!!6000000007053-2-tps-720-405.png" alt="higress-comm.png" class="img_ev3q"></p><h1>实战演示直播</h1><p>1月12号（本周四）将在线直播 Higress 通过 Nacos 实现微服务网关能力的实战演示，可以扫描图中二维码，预约观看，将在直播开始前收到短信通知。
<img loading="lazy" src="https://img.alicdn.com/imgextra/i4/O1CN01fZzh1e1EQVqOnw415_!!6000000000346-2-tps-1500-2044.png" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="详解 Nacos 的一条注册请求会经历什么？"><meta itemprop="keywords" content="Nacos,注册"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/nacos-reigster-mechanism">Nacos 的一条注册请求会经历什么？</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-28T00:00:00.000Z" itemprop="datePublished">2022年12月28日</time> · <!-- -->阅读需 15 分钟</div></header><div class="markdown" itemprop="articleBody"><p>转载且编辑自<a href="http://www.passjava.cn/#/13.SpringCloud%E6%9E%B6%E6%9E%84%E5%89%96%E6%9E%90/07.Nacos%E9%85%8D%E7%BD%AE%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/02.Nacos%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86%E2%91%A0%EF%BC%9A%E4%B8%80%E6%9D%A1%E6%B3%A8%E5%86%8C%E8%AF%B7%E6%B1%82%E4%BC%9A%E7%BB%8F%E5%8E%86%E4%BB%80%E4%B9%88%EF%BC%9F" target="_blank" rel="noopener noreferrer">Nacos 的一条注册请求会经历什么?</a></p><h1>Nacos 的一条注册请求会经历什么？</h1><h1>前言</h1><p>Nacos 作为注册中心，用来接收客户端（服务实例）发起的注册请求，并将注册信息存放到注册中心进行管理。</p><blockquote><p>那么一条注册请求到底会经历哪些步骤呢？</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="知识点预告">知识点预告<a href="#知识点预告" class="hash-link" aria-label="知识点预告的直接链接" title="知识点预告的直接链接">​</a></h3><p>先上一张整体的流程图：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220413171451070bFSgRzW3Rx0S-cf97e1427caabd564d6fad0274a46ea5.png" width="1964" height="1636" class="img_ev3q"></p><ul><li><strong>集群环境</strong>：如果是 Nacos 集群环境，那么拓扑结构是什么样的。</li><li><strong>组装请求</strong>：客户端组装注册请求，下一步对 Nacos 服务发起远程调用。</li><li><strong>随机节点</strong>：客户端随机选择集群中的一个 Nacos 节点发起注册，实现负载均衡。</li><li><strong>路由转发</strong>：Nacos 节点收到注册请求后，看下是不是属于自己的，不是的话，就进行路由转发。</li><li><strong>处理请求</strong>：转发给指定的节点后，该节点就会将注册请求中的实例信息解析出来，存到自定义的内存结构中。</li><li><strong>最终一致性</strong>：通过 Nacos 自研的 Distro 协议执行<code>延迟异步任务</code>，将注册信息同步给集群中的其他节点，保证了数据的最终一致性。</li><li><strong>异步重试</strong>：如果注册失败，客户端将会切换 Nacos 节点，再次发起注册请求，保证高可用性。</li></ul><p>这些知识点里面还有很多细节，我会通过画图 + 源码剖析的方式给大家解答。如果遇到源码看不太懂的地方，可以多看下我画的图，然后翻下源码，对照着一起看。</p><p>小 Tip：本文使用的 Nacos 版本： 2.0.4。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一源头发起注册">一、源头：发起注册<a href="#一源头发起注册" class="hash-link" aria-label="一、源头：发起注册的直接链接" title="一、源头：发起注册的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-阅读源码的小技巧">1.1 阅读源码的小技巧<a href="#11-阅读源码的小技巧" class="hash-link" aria-label="1.1 阅读源码的小技巧的直接链接" title="1.1 阅读源码的小技巧的直接链接">​</a></h3><p>在使用 Nacos 组件的的时候，我们加上一个注解 <code>@EnableDiscoveryClient</code> 就可以使服务自动注册到 Nacos。</p><blockquote><p>那么这个发起注册的地方到底在哪呢？注册信息又是长什么样的呢？</p></blockquote><p>告诉大家一个看源码的小技巧，拿到源码后，不是直接各个文件都看一篇，而是先看源码中带的 example 文件夹。如下图所示，找到 example 的 App 类，里面就有发起注册的实例代码。如下图所示：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220412071138017zxK9mw-afe9812f13ff074bc352b592aa61e87d.png" width="2564" height="844" class="img_ev3q"></p><p>当然，我们也可以通过官网给的 curl 命令发起 HTTP 请求：</p><div class="language-SH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-SH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST &#x27;http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.11&amp;port=8080&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>留个问题</strong>：我们都是加一个 Nacos 注解 <code>@EnableDiscoveryClient</code>，就会自动把服务实例注册到 Nacos，这个是怎么做到的？</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-发起注册的流程图">1.2 发起注册的流程图<a href="#12-发起注册的流程图" class="hash-link" aria-label="1.2 发起注册的流程图的直接链接" title="1.2 发起注册的流程图的直接链接">​</a></h3><p>先来看一下代码的流程图：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220412071400192DVNL4d-9665cc994a215398c3c0349099baee79.png" width="2062" height="980" class="img_ev3q"></p><p>跟着这个流程图，我们 debug 来看下。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-组装注册的实例信息">1.3 组装注册的实例信息<a href="#13-组装注册的实例信息" class="hash-link" aria-label="1.3 组装注册的实例信息的直接链接" title="1.3 组装注册的实例信息的直接链接">​</a></h3><p>入口的核心代码如下图所示，它会组装注册的<code>实例信息</code>，放到一个 instance 变量里面：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-202204111612410590Vmd01-615e535bd8410d9277bd4ec8842914f2.png" width="1332" height="548" class="img_ev3q"></p><p>通过代码调试，我们可以看到里面的实例信息长这样：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220411160413112vLIk1i-5d4ff2f5c2841480d4251c57257a7abc.png" width="990" height="554" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-组装注册请求-request">1.4 组装注册请求 request<a href="#14-组装注册请求-request" class="hash-link" aria-label="1.4 组装注册请求 request的直接链接" title="1.4 组装注册请求 request的直接链接">​</a></h3><p>发起注册的核心方法是 doRegisterService()，组装的 request 如下图所示，里面有之前组装的实例信息 instance，还有指定的  namespace（Nacos 的命名空间）、serviceName（服务名），groupName（Nacos 的分组）。</p><p><img loading="lazy" alt="image-20220411162322668" src="/zh-cn/assets/images/image-202204111623226683NnG6U-e4eacabd0ad633c9a9a720a3a7cdb813.png" width="1424" height="876" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-发起远程调用">1.5 发起远程调用<a href="#15-发起远程调用" class="hash-link" aria-label="1.5 发起远程调用的直接链接" title="1.5 发起远程调用的直接链接">​</a></h3><p>requestToServer() 方法里面会调用 RpcClient 的 request() 方法：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">response = this.currentConnection.request(request, timeoutMills);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>就是向 Nacos 发起远程调用，如果是 Nacos 集群，则是向集群中的某个 Nacos 节点发起远程调用。</p><p>接下来我们看下客户端是如何选择一个 Nacos 节点进行注册的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二集群环境分布式的前提">二、集群环境：分布式的前提<a href="#二集群环境分布式的前提" class="hash-link" aria-label="二、集群环境：分布式的前提的直接链接" title="二、集群环境：分布式的前提的直接链接">​</a></h2><p>如果是 Nacos 集群环境，客户端会随机选择一个 Nacos 节点发起注册。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-搭建好一套nacos-集群环境">2.1 搭建好一套Nacos 集群环境<a href="#21-搭建好一套nacos-集群环境" class="hash-link" aria-label="2.1 搭建好一套Nacos 集群环境的直接链接" title="2.1 搭建好一套Nacos 集群环境的直接链接">​</a></h3><p>为了讲解客户端是如何注册到 Nacos 集群环境的底层原理，我在本地搭建了一个 Nacos 集群环境，有 3 个 Nacos 服务，它们的 IP 相同，端口号不同。</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">192.168.10.197:8848</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.10.197:8858</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">192.168.10.197:8868</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="/zh-cn/assets/images/image-20220408100844549MpxWbbx40la1-8ba0634d0f1ed91ae21e24204e4a5cad.png" width="1422" height="976" class="img_ev3q"></p><p>然后<strong>服务 A 和服务 B 都是配置了 Nacos 集群</strong>的 IP 和 端口号的，配置如下所示</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">spring.cloud.nacos.discovery.server-addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  =192.168.10.197:8848,192.168.10.197:8858,192.168.10.197:8868</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>整体的结构如下图所示，服务 A 和 服务 B 都往 Nacos 集群进行注册。</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220408101723181kPWAUaDBK5jL-e96872194b8a82097957172cc89dd6c3.png" width="1596" height="1436" class="img_ev3q"></p><p><strong>但是里面有一个问题</strong>：服务 A 注册时，是向所有 Nacos 节点发起注册呢？还是只向其中一个节点发起注册？如果只向一个节点注册，要向哪个节点注册呢？</p><blockquote><p>答案：在 Client 发起注册之前，会有一个后台线程随机拿到 Nacos 集群服务列表中的一个地址。</p></blockquote><p><strong>Nacos 为什么会这样设计？</strong></p><ul><li>这其实就是一个负载均衡的思想在里面，每个节点都均匀的分摊请求。</li><li>保证高可用，当某个节点宕机后，重新拿到其他的 Nacos 节点来建立连接。</li></ul><p>接下来我们看下服务 A 是怎么随机拿到一个 Nacos 节点的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三随机节点平等的世界">三、随机节点：平等的世界<a href="#三随机节点平等的世界" class="hash-link" aria-label="三、随机节点：平等的世界的直接链接" title="三、随机节点：平等的世界的直接链接">​</a></h2><p>我们来看下客户端是如何随机选择一个节点的，流程图如下：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220412085821355AZgLcJ-676a1d38dfb9a298ef355d3b096c6733.png" width="1166" height="1256" class="img_ev3q"></p><p>那么如何找到这些代码逻辑呢？思路是怎么样的？</p><p>我们之前讲过，RpcClient 会发起 request 请求，用的是和 Nacos 建立 <code>currentConnection</code> 连接来发起调用，代码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 发起调用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">response = this.currentConnection.request(request, timeoutMills);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个 <code>currentConnection</code> 是客户端和 Nacos 集群中的某个节点建立的连接，我们找下它在哪里赋值的。代码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 拿到 Nacos 节点信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serverInfo = recommendServer.get() == null ? nextRpcServer() : recommendServer.get();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 连接 Nacos 节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connectToServer = connectToServer(serverInfo);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 赋值 currentConnection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this.currentConnection = connectToServer;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>而连接的信息是通过参数 serverInfo 传进去的，所以我们再看下 serverInfo 在哪里赋值的。</p><p>这个 nextRpcServer() 方法里面会<strong>拿到一个随机的 Nacos 地址</strong>：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 一个 int 随机数，范围 [0 ~ Nacos 个数)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">currentIndex.set(new Random().nextInt(serverList.size()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// index 自增 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int index = currentIndex.incrementAndGet() % getServerList().size();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 返回 Nacos 地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return getServerList().get(index);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>小结</strong>：客户端生成一个随机数，然后通过这个随机数从 Nacos 服务列表中拿到一个 Nacos 服务地址返回给客户端，然后客户端通过这个地址和 Nacos 服务建立连接。Nacos 服务列表中的节点都是平等的，随机拿到的任何一个节点都是可以用来发起调用的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四路由转发不是我的菜">四、路由转发：不是我的菜<a href="#四路由转发不是我的菜" class="hash-link" aria-label="四、路由转发：不是我的菜的直接链接" title="四、路由转发：不是我的菜的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-发起和转发请求的流程">4.1 发起和转发请求的流程<a href="#41-发起和转发请求的流程" class="hash-link" aria-label="4.1 发起和转发请求的流程的直接链接" title="4.1 发起和转发请求的流程的直接链接">​</a></h3><p>为了演示发起注册的流程，我在这里模拟了一个注册请求。</p><p>用的是 curl 命令，对 Nacos 节点（127.0.0.1:8848）发起注册请求：</p><div class="language-SH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-SH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST &#x27;http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.11&amp;port=8080&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>请求 URL</strong>：/nacos/v1/ns/instance</p><p><strong>请求参数</strong>：</p><ul><li>serviceName=nacos.naming.serviceName</li><li>ip=20.18.7.11</li><li>port=8080&#x27;</li></ul><p>之前我们讲到，Nacos 的有多个节点可以分别处理请求，当节点发现这个请求不是属于自己的，就会进行转发。</p><p>如下图所示：</p><p>服务 A 随机选择一个 Nacos 节点（图中为 Nacos1）发起注册请求，请求参数中包含了实例信息，Nacos 1 根据实例信息 hash + 取模拿到正确的节点，如果不属于自己，则将请求转发给其他节点（图中为 Nacos2）</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220412215250738gU1BYV-6144fe920ac12a2264f5126c937d37ea.png" width="1450" height="1336" class="img_ev3q"></p><p>那么路由转发的细节是怎么样的？这个就涉及到 Distro 协议了，我们接着往下看。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-路由转发的逻辑">4.1 路由转发的逻辑<a href="#41-路由转发的逻辑" class="hash-link" aria-label="4.1 路由转发的逻辑的直接链接" title="4.1 路由转发的逻辑的直接链接">​</a></h3><p>其实 Nacos 节点的路由转发逻辑比较简单，先来看下流程图：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220412184102530MvbD7W-03d5f24c06c1d778ca0100fbc81b6497.png" width="1226" height="1374" class="img_ev3q"></p><p>步骤如下：</p><ul><li>①  Nacos 节点从客户端发起的 request 中拿到客户端的实例信息生成 distroTag，如 IP + port 或 service name。</li><li>②  Nacos 根据 distroTag 生成 hash 值。</li><li>③  用 hash 值对 Nacos 节点数进行<code>取余</code>，拿到余数，比如 0、1、2、3。</li><li>④ 根据余数从 Nacos 节点列表中拿到指定的节点地址。</li></ul><p><strong>我没看懂的点</strong>：我这里启动了三个 Nacos 节点，如下图所示的 三个 Running 节点。但是为什么 Nacos 的 ServersList 会多了一个 192.168.10.197:8848的节点？</p><blockquote><p>开发者回答：
nacos-server存在一个机制，在启动的时候会检查cluster.conf中配置的member内容，如果发现自身不在member列表中，就会将自身地址加入到member列表中。
图中member显示有127.0.0.1的3个节点和一个192.168.10.197节点，说明nacos-server获取到的ip是192.168.10.197，但是cluster.conf中配置的ip是127.0.0.1。
需要解决的话有两种方法，一种是严格按照上文中的配置，配置ip为192.168.10.197，另一种方式是在启动服务是设置JVM参数-Dnacos.server.ip=127.0.0.1
这个配置错误同样常见于使用K8S搭建Nacos集群，域名和hostname互相混用时出现。</p></blockquote><p><img loading="lazy" alt="IDEA 启动了三个 nacos 节点" src="/zh-cn/assets/images/image-202204122033417675s0J4F-d1e08a906f3afbf3285b330f56afe9a9.png" width="792" height="356" class="img_ev3q"></p><p><img loading="lazy" alt="nacos 控制台有四个节点" src="/zh-cn/assets/images/image-20220413153431838s2Wj4W-c33f05c6a2798639dbf30617d7c6afb3.png" width="1828" height="998" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-路由转发源码分析">4.2 路由转发源码分析<a href="#42-路由转发源码分析" class="hash-link" aria-label="4.2 路由转发源码分析的直接链接" title="4.2 路由转发源码分析的直接链接">​</a></h3><p>入口文件是 DistroFilter.java：</p><div class="language-SH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-SH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">naming/src/main/java/com/alibaba/nacos/naming/web/DistroFilter.java</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>请求会先到 DistroFilter 类的 doFilter() 方法，拿到正确的节点地址后，将请求转发出去。</p><p>获取需要转发节点地址的代码如下：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// 找到 Nacos 集群中的目标节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">final String targetServer = distroMapper.mapSrv(distroTag);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// mapSrv 方法会先 hash，然后再取模，responsibleTag的值类似这样：&quot;20.18.7.11:8080&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int index = distroHash(responsibleTag) % servers.size();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// distroHash 方法里面会对 客户端的 ip+port 字符串或者服务名字符串 进行 hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Math.abs(responsibleTag.hashCode() % Integer.MAX_VALUE);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>不论是自己处理注册请求还是转发给其他节点来处理，都会把实例信息存储起来，那么是如何进行存储的？</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="五处理请求快到碗里来">五、处理请求：快到碗里来<a href="#五处理请求快到碗里来" class="hash-link" aria-label="五、处理请求：快到碗里来的直接链接" title="五、处理请求：快到碗里来的直接链接">​</a></h2><p>Nacos 目前有两个版本，v1 和 v2，如果是 v1，则是 instanceController 来处理注册请求，否则用 instanceControllerV2。本篇我们只讲解 v1 版本是怎么处理请求的。</p><p>先上流程图：</p><p><img loading="lazy" alt="添加实例信息的流程" src="/zh-cn/assets/images/image-20220413164932907KHTvVM-1ea8de71447055276f1afbae22199828.png" width="1366" height="1360" class="img_ev3q"></p><p>测试用的发起注册的命令：</p><div class="language-SH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-SH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X POST &#x27;http://127.0.0.1:8858/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.11&amp;port=8080&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>核心代码就是这个：</p><p><img loading="lazy" alt="服务端注册实例的方法" src="/zh-cn/assets/images/image-20220413160148289ylcS1n-5f60cb502dbe3dd369cd47497e22476a.png" width="1624" height="768" class="img_ev3q"></p><p>有一个 synchronized 锁，将临时的实例信息存放起来，所以重点看下 这个 consistencyService.put() 方法做了什么事情。</p><p>先看下源码：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">onPut(key, value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 开启 1s 的延迟任务，将数据同步给其他 Nacos 节点</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">distroProtocol.sync(new      DistroKey(key,KeyBuilder.INSTANCE_LIST_KEY_PREFIX),DataOperation.CHANGE,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                DistroConfig.getInstance().getSyncDelayMillis());</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这里面做了三件事情：</p><ul><li>① 将实例信息存放到内存缓存 concurrentHashMap 里面。</li><li>② 添加一个任务到 BlockingQueue 里面，这个任务就是将最新的实例列表通过 UDP 的方式推送给所有客户端（服务实例），这样客户端就拿到了最新的服务实例列表。</li><li>③ 开启 1s 的延迟任务，将数据通过给其他 Nacos 节点。</li></ul><p><strong>注意</strong>：针对第二点和第三点，属于 Distro 一致性协议的一部分，里面的内容还比较多，我们放到下一讲专门来讲。</p><p><strong>知识点预告</strong>：</p><ul><li><p>这里的存储实例和同步的方式和 Eureka 有什么区别？Eureka 用的三层缓存架构，Nacos 用的 CopyOnWrite 技术。</p></li><li><p>如何推送给所有客户端的？UDP 方式。</p></li><li><p>如何同步给 Nacos 其他节点的？Distro 一致性协议。</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="六总结">六、总结<a href="#六总结" class="hash-link" aria-label="六、总结的直接链接" title="六、总结的直接链接">​</a></h2><p>本文通过发起一条注册请求，讲解了 Nacos 客户端如何随机选择节点、Nacos Server 如何路由、Nacos Server 如何存储注册实例。</p><p><strong>核心流程</strong>：</p><p><img loading="lazy" src="/zh-cn/assets/images/image-20220413171451070bFSgRz-20220530201153679-cf97e1427caabd564d6fad0274a46ea5.png" width="1964" height="1636" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Nacos 2.2.0 版本发布，新增多种插件支持！"><meta itemprop="keywords" content="2.2.0,plugins"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/2.2.0-release">Nacos 2.2.0 版本发布，新增多种插件支持</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-16T00:00:00.000Z" itemprop="datePublished">2022年12月16日</time> · <!-- -->阅读需 7 分钟</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="新版本发布">新版本发布<a href="#新版本发布" class="hash-link" aria-label="新版本发布的直接链接" title="新版本发布的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="220正式版-版本特性">2.2.0正式版 版本特性<a href="#220正式版-版本特性" class="hash-link" aria-label="2.2.0正式版 版本特性的直接链接" title="2.2.0正式版 版本特性的直接链接">​</a></h3><p>Nacos社区于10月分发布了2.2.0-BETA版本，根据近1个多月的社区反馈，2.2.0-BETA没有发现严重的核心功能问题，主要的反馈集中在数据库插件的优化修复以及一些小bug修复。</p><p>因此不再进行BETA2版本的发布，而直接发布2.2.0的GA正式版。</p><p><img loading="lazy" alt="2.2.0架构图" src="/zh-cn/assets/images/220-structure-c66bcd05e9bc221ef36ccdd0251f5184.png" width="1818" height="898" class="img_ev3q"></p><p>2.2.0版本是2.X中一个较为重要的版本，它包含了一些较为重大的改动：</p><p>首先，2.2.0将会删除旧的冗余代码，即1.X模式服务发现和双写相关代码。删除后，2.2.0版本将无法从Nacos 1.X服务器升级，只能从至少2.0.0版本升级。此更改不会影响对1.X客户端请求的适配，用户仍然可以使用1.X客户端链接2.2.0版本服务端。</p><p>其次，2.2.0添加了数个新的插件支持，例如 <a href="/zh-cn/docs/v2/plugin/datasource-plugin">数据源插件</a>、<a href="/zh-cn/docs/v2/plugin/custom-environment-plugin">自定义环境变量插件</a>和<code>限流管控插件</code>。</p><p>其中<a href="/zh-cn/docs/v2/plugin/custom-environment-plugin">自定义环境变量插件</a>是社区需求配置加密数据库密码的需求的升级抽象插件，允许通过插件的方式对nacos服务端启动时的配置进行特殊处理，比如可以配置数据库密码为密文，在插件中进行解密，以此来支持配置加密数据库密码以及后续可能有的其他关于配置特殊处理的需求。</p><p><code>限流管控插件</code>是将早期开源之夏项目中的连接限流模块进行插件化改造后的插件，可提供用户以扩展的方式编写限流管控能力，以保护Nacos服务端在高压下运行的稳定性。</p><blockquote><p>由于限流管控插件的改造还未完全完成，目前将不会发布插件SPI至maven仓库中，想要尝试的开发者或用户可以根据Nacos 源代码中 plugin/control 下的SPI先行拓展使用，帮助社区更早的发现问题。</p></blockquote><p>最后，2.2.0增强了在2.1.1版本被列为beta功能的<code>轨迹追踪插件</code>和<code>批量注册</code>，这使它们更易于使用。关于如何开发和使用<code>轨迹追踪插件</code>，可以参考<a href="/zh-cn/docs/v2/plugin/trace-plugin">插件文档</a>进行开发。</p><p>2.2.0 版本具体变更内容可参考变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> feature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#5863</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9331</span><span class="token url" style="color:#36acaa">]</span><span class="token plain"> Support batch register and batch deregister service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8308] Add v2 openAPI for nacos 2.0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8312] Support datasource plugins.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8481] Support track tracing plugins.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8694] Support prometheus http service discovery(prometheus http sd).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9318] Support caseSentive for Ldap auth plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9366] Support Ldaps authentication.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement&amp;Refactor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7930] Reomve old redundant codes about 1.x naming.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9391] Optimization Chooser.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9393] Make server stop auto when starting error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9414] Optimize fuzzy queries to make SQL more general.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#9415</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9449</span><span class="token url" style="color:#36acaa">]</span><span class="token plain">[#9466][#9497] Enhancement datasource plugins.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9423] ExternalDataSourceProperties add isEmpty check to support external config.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9459] Modify the method modifier of NacosApplicationListener to default.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9471] Keep console query condition in configuration After return list config pages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9597] Keep console query condition in discovery After return list service pages.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9615] Enhance client choose server node to request server more dispersed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9653] Refactor connection limit module to plugin.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9334] Fix group_id data length different in many tables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9341] Fix can not create bean ldapAuthenticationProvider.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9351] Fix instance count error in prometheus metrics.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9367] Fix auth plugin&#x27;s property &#x27;token.secret.key&#x27; base64 decode error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#9408</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9437</span><span class="token url" style="color:#36acaa">]</span><span class="token plain"> Fix console namespace list deploy problems.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9461] Fix ClientWorker NullPointer judgement order.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9474] Fix some instance is unhealthy after change to http health check.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9478] Fix the chooser bug when all instances have a zero weight.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9584] Fix console configuration query button overflow hidden problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9586] Fix problem of deregister instance failure after service expired metadata auto clean.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Dependency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9652] Upgrade ui dependencies to fix some depend vulnerability.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="社区">社区<a href="#社区" class="hash-link" aria-label="社区的直接链接" title="社区的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="贡献者激励活动">贡献者激励活动<a href="#贡献者激励活动" class="hash-link" aria-label="贡献者激励活动的直接链接" title="贡献者激励活动的直接链接">​</a></h3><p>在2.1.1版本发布时，许多小伙伴收到了Nacos社区的小礼品，2.2.0版本发布后，又一期的礼品如期而至，本次礼品主要针对在7月初至12月初期间，为Nacos及其周边生态产品有所贡献的新贡献者以及保持持续贡献的优秀贡献者们。欢迎更多的新鲜贡献者加入Nacos社区，同时也欢迎获得了礼品的贡献者们可以继续贡献社区，激励活动会一直保持～期待收集齐所有的Nacos社区礼品哦～</p><p>本次的礼品将会是Nacos&amp;Seata&amp;Higress的帆布袋，请没留下联系方式的贡献者们尽快在github上添加，以免错过活动～</p><table><thead><tr><th><img loading="lazy" alt="bag_nacos.jpg" src="/zh-cn/assets/images/bag_nacos-26a0549ab3caa40d6fe278d3071a481a.jpg" width="960" height="1280" class="img_ev3q"></th><th><img loading="lazy" alt="bag_seata.jpg" src="/zh-cn/assets/images/bag_seata-6c5ed1e20952fee8f2782dcfb1ac91c6.jpg" width="960" height="1280" class="img_ev3q"></th></tr></thead></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="展望">展望<a href="#展望" class="hash-link" aria-label="展望的直接链接" title="展望的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2x-后续计划">2.X 后续计划<a href="#2x-后续计划" class="hash-link" aria-label="2.X 后续计划的直接链接" title="2.X 后续计划的直接链接">​</a></h3><p>从2021年3月 2.0.0正式版发布至今，2.X版本已经走了接近2年时间，如今2.2.0版本发布，说明2.X版本已经逐渐成熟稳定，在2.X的后续计划中，除了鼓励社区中提供和完善已有的插件多种实现以外，依旧会为其易用性和扩展性进一步增强，添加更多的插件功能：</p><ul><li>寻址插件</li><li>配置变更钩子插件</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="30-计划">3.0 计划<a href="#30-计划" class="hash-link" aria-label="3.0 计划的直接链接" title="3.0 计划的直接链接">​</a></h3><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a>的畅想和规划，Nacos将会从统一控制面、支持国产化、存储计算分离等方向进一步演进Nacos的功能和架构，欢迎社区积极参与到新版本的建设中。
<img loading="lazy" alt="image.png" src="/zh-cn/assets/images/220-roadmap-4f6c43b09ff72f49d669db4d09a9634d.png" width="2308" height="792" class="img_ev3q">
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;id=rUihF&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="image.png" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>最后欢迎大家扫码加入Nacos社区群</p><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280778-c1822fb0-958b-4730-a6dc-0e92ba22f3f8.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=374&amp;id=u2619495f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=923&amp;originWidth=765&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=338166&amp;status=done&amp;style=none&amp;taskId=u0690e9a0-6d58-4f72-82b1-7d4457a900e&amp;title=&amp;width=310" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="Nacos 2.1.2、2.2.0-BETA及go-sdk 2.1.1 版本同时发布，多语言生态再添大将。"><meta itemprop="keywords" content="2.1.2,2.2.0-BETA,go-sdk,rust-sdk"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/212-and-220beta-release">Nacos 2.1.2、2.2.0-BETA及go-sdk 2.1.1 版本同时发布，多语言生态再添大将</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-10-28T00:00:00.000Z" itemprop="datePublished">2022年10月28日</time> · <!-- -->阅读需 10 分钟</div></header><div class="markdown" itemprop="articleBody"><p>距离2.1.1版本发布2个月后，Nacos社区又迎来一波大更新。本次发布包含了2个server版本，1个go-sdk版本以及新语言sdk的预告。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="nacos-212">Nacos 2.1.2<a href="#nacos-212" class="hash-link" aria-label="Nacos 2.1.2的直接链接" title="Nacos 2.1.2的直接链接">​</a></h2><p>2.1.2 主要增强了控制台的UI效果，变更了控制台的样式，使得内容更加紧凑美观；</p><p>另外2.1.2对客户端大小进行了优化，大幅降低了客户端的jar包大小，同时还提供了纯净版java-client，方便没有依赖gRPC或希望使用非shaded版本客户端用户使用，可以到<a href="/zh-cn/docs/v2/guide/user/sdk">Java SDK</a>中查看纯净版使用方式。</p><p>最后2.1.2修复了许多旧版本的问题，提高了稳定性。具体变更内容可参考变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#6112] Unified derby-data variables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7929] Reduce nacos-client jar size by minijar.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8941] Support Fuzzy Query in Authority Control--for api change.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8956] Internationalize product description content in nacos console.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8976] Create new namespace with duplicate namespace show name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9091] build pure nacos-client when release.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9210] Naming Distro sync support revision.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Refactor&amp;dependency</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8611] Close old datasource connection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8650] Make cluster/report both receive and send metadata.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9013] refactor rpcClient and grpcClient to support set configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9014] refactor TpsMonitorPoint.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9177] Upgrade org.yaml.snakeyaml version from 1.30 to 1.32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9325] Add switch for naming async query.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8882] Fix nacos-client 2.1.0 start error when using endpoint configuration.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8910] Fix calculate instance count error when using batch register.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8925] Fix the value of hasQueryString is always false.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8928] Fix the replaceAll operation is invalid for server list.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8931] Fix BatchInstanceData can&#x27;t serialize problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8934] Fix header lost when request retrying.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8947] Fix the authentication/encryption plugin are not loaded on the nacos server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9023] Fix corner case config dataId &#x27;cipher-&#x27; can&#x27;t be create.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9047] Fix ServerListMgr is not shutdown in nacos-client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9060] Fix print logs for NamingTraceEvent continuously.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9062] Fix unsubscribe service failed problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9101] Fix the ConnectionTimeout property in the datasource connection is overwritten problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9227] Fix instance change event subscribe failed in 2.1.1 when no setting scope.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9230] Fix error event order for snapshot loading.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9269] Fix RpcClient parse ipv6 address error problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#9271</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#6876</span><span class="token url" style="color:#36acaa">]</span><span class="token plain"> Fix &#x27;JraftServer&#x27; NPE after server exceptionally shutdown.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9277] Fix ClientServiceIndex not clean when service removed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9305] Fix build resource with error dataId.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9311] Fix cache not removed when listener adding delay.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9323] Fix service checking problem in 1.x http openAPI.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="220-beta">2.2.0-BETA<a href="#220-beta" class="hash-link" aria-label="2.2.0-BETA的直接链接" title="2.2.0-BETA的直接链接">​</a></h2><p>2.2.0版本是2.X中一个较为重要的版本，它包含了一些较为重大的改动：</p><p>首先，2.2.0将会删除旧的冗余代码，即1.X模式服务发现和双写相关代码。删除后，2.2.0版本将无法从Nacos 1.X服务器升级，只能从至少2.0.0版本升级。此更改不会影响对1.X客户端请求的适配，用户仍然可以使用1.X客户端链接2.2.0版本服务端。</p><p>其次，2.2.0将会合并部分阿里巴巴编程之夏2022和开源之夏2022的课题结果，例如<a href="/zh-cn/docs/v2/guide/user/open-api">V2版本的 openAPI</a> 和 <a href="/zh-cn/docs/v2/plugin/datasource-plugin">数据源插件</a>。其他课题也将在未来版本中发布。</p><p>最后，2.2.0增强了在2.1.1版本被列为beta功能的<code>轨迹追踪插件</code>和<code>批量注册</code>，这使它们更易于使用。关于如何开发和使用<code>轨迹追踪插件</code>，可以参考<a href="/zh-cn/docs/v2/plugin/trace-plugin">插件文档</a>进行开发。</p><p>由于这个版本中有许多重要的变化，所以社区计划做一个预发布的BETA版本。根据BETA测试的结果，下一个版本计划是BETA2或GA版本，欢迎广大用户积极<a href="https://github.com/alibaba/nacos/releases/tag/2.2.0-BETA" target="_blank" rel="noopener noreferrer">下载</a>试用测试，帮助社区尽早发现问题。</p><blockquote><p>注意：2.2.0-BETA是一个预发布的beta版本，可能存在一些问题，请尽量避免在生产环境中使用。</p></blockquote><p>2.2.0-BETA版本具体变更内容可参考变更日志：</p><div class="language-markdown codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-markdown codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> feature</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token url" style="color:#36acaa">[</span><span class="token url content" style="color:#36acaa">#5863</span><span class="token url" style="color:#36acaa">][</span><span class="token url variable" style="color:#36acaa">#9331</span><span class="token url" style="color:#36acaa">]</span><span class="token plain"> Support batch register and batch deregister service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8308] Add v2 openAPI for nacos 2.0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8312] Support datasource plugins.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8481] Support track tracing plugins.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9366] Support Ldaps authentication.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> Enhancement</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7930] Reomve old redundant codes about 1.x naming.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token title important punctuation" style="color:#393A34">##</span><span class="token title important"> BugFix</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9334] Fix group_id data length different in many tables.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9341] Fix can not create bean ldapAuthenticationProvider.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#9351] Fix instance count error in prometheus metrics.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="多语言sdk">多语言SDK<a href="#多语言sdk" class="hash-link" aria-label="多语言SDK的直接链接" title="多语言SDK的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="go">Go<a href="#go" class="hash-link" aria-label="Go的直接链接" title="Go的直接链接">​</a></h3><p>Nacos <a href="https://github.com/nacos-group/nacos-sdk-go/releases/tag/v2.1.1" target="_blank" rel="noopener noreferrer">Go SDK v2.1.1</a> 版本也在近期发布了正式版本，在v2.1.0带来大量新特性和改进的基础上，进一步加强了使用的稳定性，欢迎大家升级使用。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rust">Rust<a href="#rust" class="hash-link" aria-label="Rust的直接链接" title="Rust的直接链接">​</a></h3><p>Rust语言是最近非常如火如荼的新编程语言生态，Nacos社区的小伙伴第一时间加入了对rust生态的建设，目前<a href="https://github.com/nacos-group/nacos-sdk-rust" target="_blank" rel="noopener noreferrer">nacos-rust-sdk</a>已完成基础的功能建设工作，同时实现了配置中心的核心功能，已发布v0.1.1版本供社区试用。</p><p>随着社区小伙伴的逐渐完善和更多愿意贡献的贡献者加入，<a href="https://github.com/nacos-group/nacos-sdk-rust" target="_blank" rel="noopener noreferrer">nacos-rust-sdk</a>很快也能够支持注册中心的功能，发布1.0的正式版本，这里也欢迎更多对rust有兴趣，希望找个项目练手的小伙伴加入一起建设nacos-rust-sdk。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="php">PHP<a href="#php" class="hash-link" aria-label="PHP的直接链接" title="PHP的直接链接">​</a></h3><p>PHP语言作为老牌服务端编程语言，以往有不少用户询问关于PHP客户端的问题；虽然社区中有很多根据openAPI自行开发的PHP客户端，但一直没有功能较全的版本和愿意持续维护捐献的PHP客户端实现，导致社区中一直没有属于nacos-group的PHP客户端。</p><p>今年由<a href="https://github.com/huangwh2014" target="_blank" rel="noopener noreferrer">huangwh2014</a>贡献到社区的PHP客户端终于能够让PHP的项目能够接入Nacos，享受Nacos所带来的各种功能。</p><p>由于该版本的<a href="https://github.com/nacos-group/nacos-sdk-php" target="_blank" rel="noopener noreferrer">PHP客户端</a>仍然是基于openAPI进行开发的，因此不具备gRPC的能力，希望社区的各位小伙伴积极参与项目，早日让PHP客户端进入2.X的时代。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="社区">社区<a href="#社区" class="hash-link" aria-label="社区的直接链接" title="社区的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="编程之夏开源之夏">编程之夏&amp;&amp;开源之夏<a href="#编程之夏开源之夏" class="hash-link" aria-label="编程之夏&amp;&amp;开源之夏的直接链接" title="编程之夏&amp;&amp;开源之夏的直接链接">​</a></h3><p>经历了6月-9月的夏日，Nacos的编程之夏和开源之夏活动也圆满结束。参与课题的9位同学也完成了他们的开源社区体验。
在此期间，有些同学完成了Nacos新openAPI，新插件的开发；有些同学完成了Nacos对K8S，Mesh化的探索；也有些同学深耕于Nacos客户端与服务端的协商机制。
根据当前功能的完成程度和Nacos社区的版本的规划，这些重要的改动会在后续版本中逐渐与大家见面。在这里感谢参加编程之夏与开源之夏的同学和导师们的热情付出，同时也感谢阿里巴巴和中科院举办的优秀的开源活动。期待明年再见。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="committer">Committer<a href="#committer" class="hash-link" aria-label="Committer的直接链接" title="Committer的直接链接">​</a></h3><p>Nacos社区新晋级了两位Committer同学。 </p><p>自由开发者<a href="https://github.com/onewe" target="_blank" rel="noopener noreferrer">onewe</a>同学主要优化统一了Nacos客户端的配置参数的加载逻辑，同时优化了LDAP鉴权插件和大量控制台使用内容，找到并修复了不少Nacos的问题。经社区PMC及Committer的投票表决，提名为Nacos社区的Committer。</p><table><thead><tr><th><img loading="lazy" alt="onewe_front.jpg" src="/zh-cn/assets/images/Onewe_front-73e1ceb81bff37ddb1963093dc3c1b88.jpg" width="567" height="854" class="img_ev3q"></th><th><img loading="lazy" alt="Onewe_bak.jpg" src="/zh-cn/assets/images/Onewe_bak-fbdadd10346ffc24f4c60d4df44a355d.jpg" width="567" height="802" class="img_ev3q"></th></tr></thead></table><p>另外来自小米科技的<a href="https://github.com/chenhao26-nineteen" target="_blank" rel="noopener noreferrer">chenhao26-nineteen</a>同学主要完成了Nacos批量注册的新功能，并且使用该新功能优化了Nacos-Sync的同步逻辑，极大提升了Nacos-Sync的性能，同时也修复了不少Nacos的问题。经社区PMC及Committer的投票表决，提名为Nacos社区的Committer。</p><table><thead><tr><th><img loading="lazy" alt="chenhao26-nineteen_front.jpg" src="/zh-cn/assets/images/chenhao26-nineteen_front-91468e978feae7d72900ae3ecd26c79e.jpg" width="567" height="854" class="img_ev3q"></th><th><img loading="lazy" alt="chenhao26-nineteen_bak.jpg" src="/zh-cn/assets/images/chenhao26-nineteen_bak-be4e2765bdbbcfd3c21f6b387a54ea64.jpg" width="567" height="802" class="img_ev3q"></th></tr></thead></table><p>期望更多小伙伴一起参与贡献～～</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a>的畅想和规划，欢迎社区积极参与到新版本的建设中。
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=" alt="image.png" class="img_ev3q"></p><p>最后欢迎大家扫码加入Nacos社区群
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280778-c1822fb0-958b-4730-a6dc-0e92ba22f3f8.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=374&amp;id=u2619495f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=923&amp;originWidth=765&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=338166&amp;status=done&amp;style=none&amp;taskId=u0690e9a0-6d58-4f72-82b1-7d4457a900e&amp;title=&amp;width=310" alt="image.png" class="img_ev3q"></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="为了庆祝 Nacos 开源四周年，我们同时推出 2.1.1 和 1.4.4 两个新版本，回馈小伙伴们的信任！"><meta itemprop="keywords" content="2.1.1,1.4.4"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/zh-cn/blog/2.1.1-release">Nacos 四周年，2.1.1 及 1.4.4 版本同时发布</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-10T00:00:00.000Z" itemprop="datePublished">2022年8月10日</time> · <!-- -->阅读需 11 分钟</div></header><div class="markdown" itemprop="articleBody"><p>2022年7月， 为了庆祝 Nacos 开源四周年，我们同时推出 2.1.1 和 1.4.4 两个新版本，回馈小伙伴们的信任！</p><p>这四年，我们完成了 1.0，2.0 两个大版本演进，发布了46个版本，快速迭代，进入中国开源活跃项目TOP10！</p><p>这四年，我们完成了从Dubbo/Spring到服务网格生态的完整支持，生态繁荣，被4600+上下游项目依赖引用！</p><p>这四年，我们市场占有率提升到了 55% 以上，官网累计访问突破100万，《Nacos 架构与原理》 突破6w阅读！</p><p>这四年，我们吸引成千上万家数字化升级企业，打造虎牙、爱奇艺、好未来、掌门、小米、小鹏、蔚来等标杆！</p><p>这四年，我们吸引了246+ contributor，30+ committer，8+ PMC，分布各大头部厂商，发挥越来越大作用！</p><p>未来，我们将全面启动 Nacos 3.0 项目，统一控制面，加大生态集成，全面提升体验，尽情期待～</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="新版本发布">新版本发布<a href="#新版本发布" class="hash-link" aria-label="新版本发布的直接链接" title="新版本发布的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="211-版本特性">2.1.1 版本特性<a href="#211-版本特性" class="hash-link" aria-label="2.1.1 版本特性的直接链接" title="2.1.1 版本特性的直接链接">​</a></h3><p>该版本核心解决 Nacos 2.0 广泛使用暴露出的一些稳定性问题（包括默认实现鉴权插件、Grpc请求和distro一致性协议的性能等），另外Beta测试“批量注册服务”和“服务追踪事件”两个新功能。</p><p>具体变更内容可查看changeLog：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## Features</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#5863] (BETA) Support batch register service.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7424] Add version data compare in the history list.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8305] (REMOVE) Remove leave nacos server nodes API temporarily.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8481] (BETA) Add TRACE Event to server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8755] Add default fuzzy search feature.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Enhancement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8099] Fast failure for distro sync task and verify task if cluster disconnect.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8150] Add the namespace description item to the namespace list page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8345] Add validation for service cluster name.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8515] Optimize some code in InetUtils.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8561] Enhance default authentication plugin performance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8574] Enhance filter service info for push callback.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8592] Ehhance GrpcUtil memory and cpu cost.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8622] Add NacosEnvironment and add some unit tests.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## Refactor&amp;dependency</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8369] Remove mina dependency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8383] Upgrade jackson version to 2.12.6.1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8421] Remove commonOkHttp dependency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8472] Remove useless dependency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8479] Refactor singleton construction as private.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8540] Upgrade spring-boot version to 2.6.8.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8594] Makes distro data load timeout can be configured.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8596] Explicitly specify spring-boot-maven-plugin version same as spring-boot.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8623] Upgrade mysql-connector-java to 8.0.28.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## BugFix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7039] Fix config encryptedData md5 calculation problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8153] Fix NPE for AutoExpireCache.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8243][#8653] Fix health check plugin problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8275] Fix can&#x27;t register service when use skywalking.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8295] Fix can&#x27;t login when use embedded storage in cluster model.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8318] Fix findAllConfigInfoForDumpAll sql args error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8372] Fix client can&#x27;t use https connection.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8424] Fix cycle dependency problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8428] Fix naming subscribe bug when multiple NamingService.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8505] Fix log configuration conflict in spring-boot project.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8514][#8539] Fix prometheus api error in client.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8516] Fix the persistent instance becomes a temporary instance.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8602] Fix display error after delete current namespace.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8632] Fix subscribe disabled instance problem in the first time.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8635] Fix NPE when call the shutdown method.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8720] Fix the problem that config aspect invalid problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8742] Fix change instance metadata, the revision of service not change.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8784] Fix some bugs for Console UI.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8833] Fix import config failed when open auth.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8880] Fix constantly loading config when not read permission.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="批量注册服务----batchregister">批量注册服务 -- batchRegister<a href="#批量注册服务----batchregister" class="hash-link" aria-label="批量注册服务 -- batchRegister的直接链接" title="批量注册服务 -- batchRegister的直接链接">​</a></h4><p>批量注册服务的需求主要来自于Nacos社区的另一个组件 -- Nacos-Sync，Nacos-Sync作为一个支持多注册中心迁移的第三方工具，一直帮助社区用户平滑的从Eureka，Consul等其他注册中心迁移到Nacos中。</p><p>在Nacos2.0发布后，Nacos-Sync第一时间进行了更新。但在更新后，由于Nacos2.0的注册机制发生了一定的变化，同一个客户端针对同一个服务只能注册一个实例，这导致了Nacos-Sync这种代理服务模式无法使用同一个客户端进行同一个服务的多个实例的代理注册，易用性大大降低。</p><p>同时社区发现，有一些特殊的应用，如网关，proxy，dubbo3多协议支持等，也需要一些代理注册的能力，因此社区在进行数次方案讨论后，最终由社区同学<a href="https://github.com/chenhao26-nineteen" target="_blank" rel="noopener noreferrer">chenhao26-nineteen</a> 完成批量注册服务的功能开发，并在2.1.1版本进行beta测试。</p><p>批量注册服务功能主要用于代理注册的场景，允许应用使用同一个客户端对同一个服务进行多个实例的注册请求。大多数传统使用场景下，用户仍然使用registerService功能即可。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="服务追踪事件----trace-event">服务追踪事件 -- trace event<a href="#服务追踪事件----trace-event" class="hash-link" aria-label="服务追踪事件 -- trace event的直接链接" title="服务追踪事件 -- trace event的直接链接">​</a></h4><p>自从阿里云的<a href="https://www.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_blank" rel="noopener noreferrer">MSE</a> Nacos发布了关于<a href="https://developer.aliyun.com/article/982835?utm_content=m_1000348405" target="_blank" rel="noopener noreferrer">推送轨迹</a>相关的文章后，社区反响热烈，都希望能在开源添加对应的功能。</p><p><a href="https://www.aliyun.com/product/aliware/mse?spm=nacos-website.topbar.0.0.0" target="_blank" rel="noopener noreferrer">MSE</a>团队得知社区的强烈需求后，由<a href="https://github.com/scienceZ" target="_blank" rel="noopener noreferrer">scienceZ</a>同学完成对事件抽象剥离，并贡献到开源社区。</p><p>目前该功能同样属于beta测试，暂时只能通过在源码中订阅对应事件的方式进行追踪，后续版本同样会将该功能作为SPI插件的形式开放，方便社区同学按照自己的需求定制推送轨迹。</p><blockquote><p>注意： 上述两个功能均属于Beta测试阶段，其API，功能可能与后续正式发布时的有一定区别。</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="144-版本特性">1.4.4 版本特性<a href="#144-版本特性" class="hash-link" aria-label="1.4.4 版本特性的直接链接" title="1.4.4 版本特性的直接链接">​</a></h3><p>Nacos 1.X版本已经不再进行功能演进，只进行一些bugfix和优化，因此本次版本发布主要也是进行一些bug的修复和优化，并且将一些可能有问题的依赖进行升级；建议大家尽快升级到 Nacos 2.0，以便享受快速迭代红利！</p><p>具体变更内容可查看changeLog：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Enhancement</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#5344] Reset raft cluster ops for no leader by JRaft Api.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#5884][#7810] Add the permission for history config.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7284] Enhance print exception details.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7799] Enhance console exception handler.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7802] Enhance thread pool manager.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7801] Enhance connection release timeout between server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7803] Apply some Jraft Enhancement from 2.X.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7925] Client stops the UpdateTask after a service is unsubscribed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8072] Reduce memory cost in DistroProtocol initialization to avoid OutOfMemoryError.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8144] Add volatile modifier to NamingProxy.serversFromEndpoint.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8203] Fix the concurrency problem about the iterator of ServerListManager.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8434] Enhance DistroConsistencyServiceImpl listen/unListen.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># BugFix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#6198][#7809] Fix StringUtils.join throw NullPointerException.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#6273] Fix loop leave server.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7141][#7804] Fix the problem of the operator column being empty while configuring adding and deleting records.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7750][#7869] Fix bug in permissions management module, such as redundant &#x27;nacos,&#x27; when change password.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7757][#7761] Fix jraft request parse failed problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7807] Fix yaml parse concurrent problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7836] Fix nacos-client can&#x27;t parse `localhost` problem.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8012] Fix NPE in DistroConsistencyServiceImpl.Notifier.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8283] Fix thread safety problem when concurrently registering with the same cluster.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8428] Fix naming subscribe bug when multiple NamingService .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8539] Fix prometheus api error.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Dependency</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7813] Upgrade log4j2 to 2.17.1.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7813] Upgrade logback to 1.2.9.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#7813] Upgrade Jraft to 1.3.9.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8421] Remove commonOkHttp dependency.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[#8169] Upgrade spring-boot version to 2.6.6.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="社区">社区<a href="#社区" class="hash-link" aria-label="社区的直接链接" title="社区的直接链接">​</a></h2><p>随着社区不断壮大和发展，在2.1.1版本中社区小伙伴贡献了90%+代码，说明Nacos社区协作进入一个成熟阶段，相信很快会有一大批的新兴贡献者要加入Nacos Committer的行列，加速推动社区演进。同时我们也为社区小伙伴提供了丰富的礼物，期望更多小伙伴一起参与贡献～</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="贡献者激励活动">贡献者激励活动<a href="#贡献者激励活动" class="hash-link" aria-label="贡献者激励活动的直接链接" title="贡献者激励活动的直接链接">​</a></h3><p>在2.1.0版本发布时，许多小伙伴收到了Nacos社区的小礼品，随着2.1.1版本发布，又一期的礼品蓄势待&quot;发&quot;，本次礼品主要针对在4月初至6月底期间，为Nacos及其周边生态产品有所贡献的新贡献者以及保持持续贡献的优秀贡献者们。欢迎更多的新鲜贡献者加入Nacos社区，同时也欢迎获得了礼品的贡献者们可以继续贡献社区，激励活动会一直保持～期待收集齐所有的Nacos社区礼品哦～</p><p>本次的礼品将会是Nacos的长柄雨伞，请没留下联系方式的贡献者们尽快在github上添加，以免错过活动～</p><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/jpeg/1577777/1660125287464-ef4355fa-e7bb-46b2-a85b-c4ca5c909ceb.jpeg#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=1290&amp;id=u9a9fa905&amp;margin=%5Bobject%20Object%5D&amp;name=IMG_20220809_164412.jpg&amp;originHeight=2580&amp;originWidth=3071&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=ude784ee7-53c4-4366-a506-2fc189a1c93&amp;title=&amp;width=1535.5" alt="umbrella.jpg" class="img_ev3q"></th></tr></thead></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="中间件开发者-meetup">中间件开发者 MeetUp<a href="#中间件开发者-meetup" class="hash-link" aria-label="中间件开发者 MeetUp的直接链接" title="中间件开发者 MeetUp的直接链接">​</a></h3><p>近期，阿里云在杭州举办了<a href="https://developer.aliyun.com/article/986002" target="_blank" rel="noopener noreferrer">中间件开发者 Meetup</a>，Nacos 也参加了该MeetUp的杭州站线下活动，并且有幸邀请到了禾连健康的CTO--邓志豪大佬来分享 Nacos微服务体系在禾连健康的落地应用。对杭州站有兴趣又没有在当时收看直播或到现场的同学，可以<a href="https://yqh.aliyun.com/live/detail/29133" target="_blank" rel="noopener noreferrer">查看回看</a>和<a href="https://github.com/mse-group/Slides" target="_blank" rel="noopener noreferrer">下载演讲PDF</a>。另外<a href="https://developer.aliyun.com/article/986002" target="_blank" rel="noopener noreferrer">中间件开发者 Meetup</a>会在其他城市相继举办，想要到现场参与或者分享的同学，可以积极参与～</p><table><thead><tr><th><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/jpeg/1577777/1660125286406-d088463e-20df-47e9-812b-58a58427be1f.jpeg#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=1302&amp;id=u690edac9&amp;margin=%5Bobject%20Object%5D&amp;name=THS6110.JPG&amp;originHeight=2603&amp;originWidth=3905&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=uaa7cd91f-70f5-4e4e-b84b-e78c882f6a7&amp;title=&amp;width=1952.5" alt="meetup1.JPG" class="img_ev3q"></th></tr></thead><tbody><tr><td><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/jpeg/1577777/1660125296258-b98425c3-478f-44e9-9736-0d1bb31ab7c1.jpeg#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=1368&amp;id=u862349c0&amp;margin=%5Bobject%20Object%5D&amp;name=THS6126.JPG&amp;originHeight=2735&amp;originWidth=4102&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;taskId=u3414f330-5d2c-49a9-8569-01f045626d1&amp;title=&amp;width=2051" alt="meetup2.JPG" class="img_ev3q"></td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="about-nacos">About Nacos<a href="#about-nacos" class="hash-link" aria-label="About Nacos的直接链接" title="About Nacos的直接链接">​</a></h2><p>Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。</p><p>Nacos 帮助您更敏捷和容易地构建、交付和管理微服务平台。 Nacos 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p><p>Nacos社区同时也开启了关于<a href="https://mp.weixin.qq.com/s/8UwwD_WxSJINP8Qr_1wogg" target="_blank" rel="noopener noreferrer">Nacos3.0</a>的畅想和规划，欢迎社区积极参与到新版本的建设中。
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280551-a2e881fe-d25e-4ebb-a28f-8e56683deef1.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=url&amp;id=Z9to1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=794&amp;originWidth=1650&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=185821&amp;status=done&amp;style=none&amp;taskId=u63849e10-1dae-45cb-b559-04d106ebe86&amp;title=" alt="image.png" class="img_ev3q"></p><p>最后欢迎大家扫码加入Nacos社区群
<img loading="lazy" src="https://cdn.nlark.com/yuque/0/2022/png/1577777/1660125280778-c1822fb0-958b-4730-a6dc-0e92ba22f3f8.png#clientId=uf10cb19a-105c-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=374&amp;id=u2619495f&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=923&amp;originWidth=765&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=338166&amp;status=done&amp;style=none&amp;taskId=u0690e9a0-6d58-4f72-82b1-7d4457a900e&amp;title=&amp;width=310" alt="image.png" class="img_ev3q"></p></div></article><nav class="pagination-nav" aria-label="博文列表分页导航"><a class="pagination-nav__link pagination-nav__link--next" href="/zh-cn/blog/page/2"><div class="pagination-nav__label">较旧的博文</div></a></nav></main></div></div></div></div>
<script src="/zh-cn/assets/js/runtime~main.58d39aa6.js"></script>
<script src="/zh-cn/assets/js/main.3a9d0c99.js"></script>
</body>
</html>